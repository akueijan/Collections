"use strict";var index_view=new Vue({el:"#app",data:{ie11:!1,deScore:0,sec:0},methods:{handleSuccess:function(o){var a=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;for(var e=document.getElementById("s"),r=(document.getElementById("p"),document.getElementById("d")),t=0;t<16;t++)r.innerHTML+="<div></div>";var i=document.querySelectorAll("#d div"),n=new AudioContext,c=n.createMediaStreamSource(o),s=new Recorder(c);s.record();var d=n.createAnalyser();c.connect(d),d.connect(n.destination),d.fftSize=32;d.frequencyBinCount;var l,u=new Uint8Array(d.fftSize);!function e(){console.log(u);d.getByteFrequencyData(u);l=setTimeout(e,200);var t=0;for(var n=0;n<16;n++)i[n].style.width=u[n]+"px",i[n].style.background="rgba("+(255-n)+","+2*n+",0,1)",t+=u[n];console.log("sum",t);v+=t;console.log("total",v);t<a.deScore?a.sec+=1:a.sec=0;if(25<=a.sec){alert("失敗"),o.getTracks().forEach(function(e){e.stop()}),clearTimeout(l);for(var n=0;n<16;n++)i[n].style.width="0px",i[n].style.transition="0.6s",r.innerHTML="";i=[],s.stop(),s.clear()}}();var v=0;function g(){o.getTracks().forEach(function(e){e.stop()}),clearTimeout(l);for(var e=0;e<16;e++)i[e].style.width="0px",i[e].style.transition="0.6s",r.innerHTML="";i=[],s.stop(),s.exportWAV(function(e){var t=URL.createObjectURL(e),n=document.createElement("li"),o=document.createElement("audio"),a=document.createElement("a");o.controls=!0,o.src=t,a.href=t,a.download=(new Date).toISOString()+".wav",a.innerHTML=a.download,n.appendChild(o),n.appendChild(a),recordingslist.appendChild(n)}),s.clear()}e.onclick=function(){g()}},mediaTest:function(t){var o=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;for(var n=document.getElementById("d"),e=0;e<16;e++)n.innerHTML+="<div></div>";var a=document.querySelectorAll("#d div"),r=new AudioContext,i=r.createMediaStreamSource(t),c=r.createAnalyser();i.connect(c),c.connect(r.destination),c.fftSize=32;c.frequencyBinCount;var s,d=new Uint8Array(c.fftSize);!function e(){console.log(d);c.getByteFrequencyData(d);s=setTimeout(e,200);var t=0;for(var n=0;n<16;n++)a[n].style.width=d[n]+"px",a[n].style.background="rgba("+(255-n)+","+2*n+",0,1)",t+=d[n];u++;console.log("sum",t);l+=t;console.log("total",l);o.deScore=Math.round(l/u)}();var l=0,u=0;setTimeout(function(){t.getTracks().forEach(function(e){e.stop()}),clearTimeout(s);for(var e=0;e<16;e++)a[e].style.width="0px",a[e].style.transition="0.6s",n.innerHTML="";a=[]},3e3)},startGame:function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1,muted:!0}).then(this.handleSuccess).catch(function(e){console.log(e.name+": "+e.message)})},testStart:function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1,muted:!0}).then(this.mediaTest).catch(function(e){console.log(e.name+": "+e.message)})}},mounted:function(){}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImluZGV4X3ZpZXciLCJWdWUiLCJlbCIsImllMTEiLCJkZVNjb3JlIiwic2VjIiwiaGFuZGxlU3VjY2VzcyIsInN0cmVhbSIsInZtIiwidGhpcyIsImdldFVzZXJNZWRpYSIsIm5hdmlnYXRvciIsIndlYmtpdEdldFVzZXJNZWRpYSIsIm1vekdldFVzZXJNZWRpYSIsIm1zR2V0VXNlck1lZGlhIiwiZ2V0RWxlbWVudEJ5SWQiLCJkb2N1bWVudCIsImRkIiwiaSIsImNvbnRleHQiLCJBdWRpb0NvbnRleHQiLCJtaWNyb3Bob25lIiwiY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UiLCJyZWNvcmQiLCJyZWNvcmRlciIsImNyZWF0ZUFuYWx5c2VyIiwiYW5hbHlzZXIiLCJjb25uZWN0IiwiZGVzdGluYXRpb24iLCJmcmVxdWVuY3lCaW5Db3VudCIsInRpbWVyIiwiYnVmZmVyTGVuZ3RoIiwiZmZ0U2l6ZSIsInVwZGF0ZSIsImxvZyIsImRhdGFBcnJheSIsImdldEJ5dGVGcmVxdWVuY3lEYXRhIiwic2V0VGltZW91dCIsInN1bSIsImoiLCJzdHlsZSIsIndpZHRoIiwiYmFja2dyb3VuZCIsImNvbnNvbGUiLCJ0b3RhbCIsImFsZXJ0IiwiZ2V0VHJhY2tzIiwiZm9yRWFjaCIsInRyYWNrIiwic3RvcCIsImNsZWFyVGltZW91dCIsInRyYW5zaXRpb24iLCJjdW4iLCJzdG9wR2FtZSIsImNsZWFyIiwiY3JlYXRlRG93bmxvYWRMaW5rIiwiYmxvYiIsInVybCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImxpIiwiY3JlYXRlRWxlbWVudCIsImF1IiwiaGYiLCJjb250cm9scyIsInNyYyIsImhyZWYiLCJkb3dubG9hZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImV4cG9ydFdBViIsImFwcGVuZENoaWxkIiwicyIsIm9uY2xpY2siLCJpbm5lckhUTUwiLCJyZWNvcmRpbmdzbGlzdCIsImQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiVWludDhBcnJheSIsIk1hdGgiLCJyb3VuZCIsIm1lZGlhRGV2aWNlcyIsImF1ZGlvIiwidmlkZW8iLCJtdXRlZCIsImVyciIsIm5hbWUiLCJtZXNzYWdlIiwidGVzdFN0YXJ0Iiwic3RhcnRHYW1lIiwidGhlbiIsIm1lZGlhVGVzdCJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsV0FBYSxJQUFJQyxJQUFJLENBQ3JCQyxHQUFJLE9BREpGLEtBQUFBLENBQ0lHLE1BRGlCLEVBRWZDLFFBQUEsRUFDRUMsSUFBRSxHQUVOQSxRQUFLLENBTFlDLGNBS1osU0FMWUMsR0FPWixJQUFBQyxFQUFBQyxLQUNMSCxVQURLSSxhQUFBQyxVQUNTSixjQUFRSSxVQUFBQyxvQkFBQUQsVUFBQUUsaUJBQUFGLFVBQUFHLGVBS2IsSUFITEgsSUFBVUQsRUFBQUEsU0FBVkssZUFBbUNMLEtBRTNCTSxHQUNBQSxTQUFTRCxlQUFlLEtBRHhCQyxTQUFTRCxlQUFqQixNQUNRQyxFQUFRLEVBQUNELEVBQUFBLEdBQUFBLElBQ1RDLEVBQUFBLFdBQVNELGNBQ2IsSUFBS0UsRUFBVEQsU0FBbUJFLGlCQUFJLFVBRXRCQyxFQUFBLElBQUFDLGFBSUdDLEVBQWFGLEVBQVFHLHdCQUF3QmYsR0FEN0NZLEVBQWNDLElBQUFBLFNBQWxCQyxHQUNJQSxFQUFVRSxTQUdkQyxJQUFTRCxFQUFUSixFQUFBTSxpQkFFSUMsRUFBV1AsUUFBUU0sR0FDdkJKLEVBQVdNLFFBQVFELEVBQW5CRSxhQUNBRixFQUFTQyxRQUFnQkMsR0FDekJGLEVBQUFHLGtCQUFBSCxJQU9TSSxFQU5MQyxFQUFlTCxJQUFBQSxXQUFTRyxFQUE1QkcsVUFRQSxTQUFBQyxJQUNZQyxRQUFJQyxJQUFBQSxHQUNKVCxFQUFDVSxxQkFBcUJELEdBQ3RCRSxFQUFBQSxXQUFtQkosRUFBM0IsS0FDTyxJQUFQSyxFQUFBLEVBQ0EsSUFBSSxJQUFJQyxFQUFFLEVBQUdBLEVBQUUsR0FBSUEsSUFBVnRCLEVBQVRzQixHQUFjQyxNQUFLRCxNQUFJSixFQUFBSSxHQUFBLEtBQ2JDLEVBQU1DLEdB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dUIsRUFBVixFQUNTakIsRUFBVCxFQW9CS1UsV0FBQSxXQVNEOUIsRUFBT3VDLFlBQVlDLFFBQVEsU0FBU0MsR0FSakNBLEVBQUFDLFNBRUVDLGFBQUxwQixHQUNRSSxJQUFJLElBQUFLLEVBQUEsRUFBUUssRUFBQUEsR0FBcEJMLElBQ0F0QixFQUFhOEQsR0FBS0MsTUFBTXBDLE1BQU1RLE1BQ2pDbkMsRUFBQXNCLEdBQUFDLE1BQUFXLFdBQUEsT0FVT3lCLEVBQUVGLFVBQVksR0FSWnpELEVBQUMsSUFDRCxNQUdOaUMsVUE3SkgsV0E4Skd2QyxVQUFBc0UsYUFBQXZFLGFBQXVCLENBQUF3RSxPQUFBLEVBQUFDLE9BQUEsRUFBQUMsT0FBQSxJQUNoQjdDLEtBU0Y5QixLQVRESCxlQURKLE1BRVVrQyxTQUFNVyxHQUNWdUIsUUFBWXhDLElBQWRtRCxFQUFBQyxLQUFBLEtBQUFELEVBQUFFLFlBUkVDLFVBekpULFdBdUtMQyxVQXJLS1IsYUFBQXZFLGFBcUtPLENBQUF3RSxPQUFBLEVBQUFDLE9BQUEsRUFBQUMsT0FBQSxJQUNGTSxLQXRLTGpGLEtBc0tEa0YsV0FESkYsTUFFY1IsU0FBVkksR0FBNkMxQyxRQUFUVCxJQUFBbUQsRUFBQUMsS0FBQSxLQUFBRCxFQUFBRSxhQUdoQzVDLFFBQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGluZGV4X3ZpZXcgPSBuZXcgVnVlKHtcclxuICAgIGVsOiBcIiNhcHBcIixcclxuICAgIGRhdGE6IHtcclxuICAgICAgICBpZTExOiBmYWxzZSxcclxuICAgICAgICBkZVNjb3JlOiAwLFxyXG4gICAgICAgIHNlYzogMFxyXG4gICAgfSxcclxuICAgIG1ldGhvZHM6IHtcclxuICAgICAgICBoYW5kbGVTdWNjZXNzKHN0cmVhbSkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLm1zR2V0VXNlck1lZGlhO1xyXG4gICAgICAgICAgICAvLyB2YXIgcGxheWVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllcicpO1xyXG4gICAgICAgICAgICB2YXIgcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzJyk7XHJcbiAgICAgICAgICAgIHZhciBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3AnKTtcclxuICAgICAgICAgICAgdmFyIGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZCcpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MDsgaTwxNjsgaSsrKXtcclxuICAgICAgICAgICAgICAgIGQuaW5uZXJIVE1MICs9ICc8ZGl2PjwvZGl2Pic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2QgZGl2Jyk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcclxuICAgICAgICAgICAgdmFyIG1pY3JvcGhvbmUgPSBjb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVjb3JkZXIgPSBuZXcgUmVjb3JkZXIobWljcm9waG9uZSk7XHJcbiAgICAgICAgICAgIHJlY29yZGVyLnJlY29yZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFuYWx5c2VyID0gY29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xyXG4gICAgICAgICAgICBtaWNyb3Bob25lLmNvbm5lY3QoYW5hbHlzZXIpO1xyXG4gICAgICAgICAgICBhbmFseXNlci5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xyXG4gICAgICAgICAgICBhbmFseXNlci5mZnRTaXplID0gMzI7XHJcbiAgICAgICAgICAgIHZhciBidWZmZXJMZW5ndGggPSBhbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudDtcclxuICAgICAgICAgICAgdmFyIGRhdGFBcnJheSA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZmdFNpemUpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB2YXIgdGltZXI7XHJcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IDA7XHJcbiAgICAgICAgICAgIHZhciBjdW4gPSAwO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFBcnJheSk7XHJcbiAgICAgICAgICAgICAgICBhbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YShkYXRhQXJyYXkpO1xyXG4gICAgICAgICAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KHVwZGF0ZSwgMjAwKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdW0gPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7IGo8MTY7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgZGRbal0uc3R5bGUud2lkdGggPSBkYXRhQXJyYXlbal0rJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICBkZFtqXS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEoJysoMjU1LWopKycsJytqKjIrJywwLDEpJztcclxuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gZGF0YUFycmF5W2pdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdW1cIiwgc3VtKTtcclxuICAgICAgICAgICAgICAgIHRvdGFsICs9IHN1bTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidG90YWxcIix0b3RhbCk7XHJcbiAgICAgICAgICAgICAgICBpZihzdW0gPCB2bS5kZVNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY3VuICs9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uc2VjICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGN1biA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uc2VjID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHZtLnNlYyA+PSAyNSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5aSx5pWXXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2suc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7IGo8MTY7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRkW2pdLnN0eWxlLndpZHRoID0gMCArJ3B4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGRbal0uc3R5bGUudHJhbnNpdGlvbiA9IFwiMC42c1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGRkID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgcmVjb3JkZXIuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlY29yZGVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzdG9wR2FtZSgpIHtcclxuICAgICAgICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKXtcclxuICAgICAgICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDsgajwxNjsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICBkZFtqXS5zdHlsZS53aWR0aCA9IDAgKydweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgZGRbal0uc3R5bGUudHJhbnNpdGlvbiA9IFwiMC42c1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRkID0gW107XHJcbiAgICAgICAgICAgICAgICByZWNvcmRlci5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVEb3dubG9hZExpbmsoKTtcclxuICAgICAgICAgICAgICAgIHJlY29yZGVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBzLm9uY2xpY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgc3RvcEdhbWUoKTtcclxuICAgICAgICAgICAgICAgIC8vIHNob3VsZFN0b3AgPSB0cnVlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlRG93bmxvYWRMaW5rKCl7XHJcbiAgICAgICAgICAgICAgICByZWNvcmRlci5leHBvcnRXQVYoZnVuY3Rpb24oYmxvYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF1ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaGYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXUuY29udHJvbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF1LnNyYyA9IHVybDtcclxuICAgICAgICAgICAgICAgICAgICBoZi5ocmVmID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgIGhmLmRvd25sb2FkID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpICsgJy53YXYnO1xyXG4gICAgICAgICAgICAgICAgICAgIGhmLmlubmVySFRNTCA9IGhmLmRvd25sb2FkO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGF1KTtcclxuICAgICAgICAgICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChoZik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVjb3JkaW5nc2xpc3QuYXBwZW5kQ2hpbGQobGkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtZWRpYVRlc3Qoc3RyZWFtKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLm1vekdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3IubXNHZXRVc2VyTWVkaWE7XHJcbiAgICAgICAgICAgIC8vIHZhciBwbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyJyk7XHJcbiAgICAgICAgICAgIHZhciBkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2QnKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8MTY7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBkLmlubmVySFRNTCArPSAnPGRpdj48L2Rpdj4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNkIGRpdicpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XHJcbiAgICAgICAgICAgIHZhciBtaWNyb3Bob25lID0gY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFuYWx5c2VyID0gY29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xyXG4gICAgICAgICAgICBtaWNyb3Bob25lLmNvbm5lY3QoYW5hbHlzZXIpO1xyXG4gICAgICAgICAgICBhbmFseXNlci5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xyXG4gICAgICAgICAgICBhbmFseXNlci5mZnRTaXplID0gMzI7XHJcbiAgICAgICAgICAgIHZhciBidWZmZXJMZW5ndGggPSBhbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudDtcclxuICAgICAgICAgICAgdmFyIGRhdGFBcnJheSA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZmdFNpemUpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB2YXIgdGltZXI7XHJcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IDA7XHJcbiAgICAgICAgICAgIHZhciBjdW4gPSAwO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFBcnJheSk7XHJcbiAgICAgICAgICAgICAgICBhbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YShkYXRhQXJyYXkpO1xyXG4gICAgICAgICAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KHVwZGF0ZSwgMjAwKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDsgajwxNjsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICBkZFtqXS5zdHlsZS53aWR0aCA9IGRhdGFBcnJheVtqXSsncHgnO1xyXG4gICAgICAgICAgICAgICAgICAgIGRkW2pdLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgnKygyNTUtaikrJywnK2oqMisnLDAsMSknO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSBkYXRhQXJyYXlbal07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdW4rKztcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3VtXCIsIHN1bSk7XHJcbiAgICAgICAgICAgICAgICB0b3RhbCArPSBzdW07XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvdGFsXCIsdG90YWwpO1xyXG4gICAgICAgICAgICAgICAgdm0uZGVTY29yZSA9IE1hdGgucm91bmQodG90YWwvY3VuKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKXtcclxuICAgICAgICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDsgajwxNjsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICBkZFtqXS5zdHlsZS53aWR0aCA9IDAgKydweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgZGRbal0uc3R5bGUudHJhbnNpdGlvbiA9IFwiMC42c1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRkID0gW107XHJcbiAgICAgICAgICAgIH0sMzAwMClcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzdGFydEdhbWUoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUsIHZpZGVvOiBmYWxzZSwgbXV0ZWQ6IHRydWUgfSlcclxuICAgICAgICAgICAgLnRoZW4odm0uaGFuZGxlU3VjY2VzcylcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubmFtZSArIFwiOiBcIiArIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB0ZXN0U3RhcnQoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUsIHZpZGVvOiBmYWxzZSwgbXV0ZWQ6IHRydWUgfSlcclxuICAgICAgICAgICAgLnRoZW4odm0ubWVkaWFUZXN0KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5uYW1lICsgXCI6IFwiICsgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBtb3VudGVkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIC8vIHZtLmdldEllKCk7XHJcbiAgICB9XHJcbn0pXHJcbiJdfQ==
