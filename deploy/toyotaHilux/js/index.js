"use strict";var index_view=new Vue({el:"#app",data:{page:"kv",step:"",question:"",resultArr:[[{word:"大哥…你這駕照一定是用<br>烤得油滋滋的雞腿換來的吧？",img:"images/result-11.png",title:"烤雞腿大師",fraction:"你的駕駛技術低於全台 99% 的人",fbLink:"https://result.friendo.com.tw/FB1PA"},{word:"看來上帝為你關起了一扇門 : 車門。",img:"images/result-12.png",title:"上帝眷顧的人",fraction:"你的駕駛技術低於全台 99% 的人",fbLink:"https://result.friendo.com.tw/FB1PB"}],[{word:"比起高超的技術，<br>你可能更需要高額的保費",img:"images/result-9.png",title:"高額要保人",fraction:"你的駕駛技術低於全台 87% 的人",fbLink:"https://result.friendo.com.tw/FB2PA"},{word:"路上的三寶飯，想必都出自您手？",img:"images/result-10.png",title:"燒臘店主廚",fraction:"你的駕駛技術低於全台 87% 的人",fbLink:"https://result.friendo.com.tw/FB2PB"}],[{word:"比起方向盤，<br>你好像比較適合洗碗盤？",img:"images/result-7.png",title:"專業洗碗工",fraction:"你的駕駛技術低於全台 66% 的人",fbLink:"https://result.friendo.com.tw/FB3PA"},{word:"關於「車」這件事<br>你還是下象棋就好",img:"images/result-8.png",title:"高階象棋棋手",fraction:"你的駕駛技術低於全台 66% 的人",fbLink:"https://result.friendo.com.tw/FB3PB"}],[{word:"人要比車兇，全台你最兇！",img:"images/result-5.png",title:"皮卡界SKY葛格",fraction:"你的駕駛技術超過全台 66% 的人",fbLink:"https://result.friendo.com.tw/FB4PA"},{word:"憑你的技術<br>當個外送員挺剛好的，是吧？",img:"images/result-6.png",title:"專業外送員",fraction:"你的駕駛技術超過全台 66% 的人",fbLink:"https://result.friendo.com.tw/FB4PB"}],[{word:"開車的技術就像唐老大一樣風騷！",img:"images/result-3.png",title:"台灣唐老大",fraction:"你的駕駛技術超過全台 87% 的人",fbLink:"https://result.friendo.com.tw/FB5PA"},{word:"送豆腐算什麼？<br>皮卡界的藤原拓海就是你！",img:"images/result-4.png",title:"皮卡界拓海哥",fraction:"你的駕駛技術超過全台 87% 的人",fbLink:"https://result.friendo.com.tw/FB5PB"}],[{word:"老司機都不夠看<br>你是萬中無一的越野老司機！",img:"images/result-1.png",title:"越野老司機",fraction:"你的駕駛技術超過全台 99% 的人",fbLink:"https://result.friendo.com.tw/FB6PA"},{word:"正港民間車神<br>車神只是兩個字，卻跟了你一輩子！",img:"images/result-2.png",title:"正港民間車神",fraction:"你的駕駛技術超過全台 99% 的人",fbLink:"https://result.friendo.com.tw/FB6PB"}]],result:{},resultMan:"",videoIntro:!1,videoPlay:!1,userScore:0,agreeArr:[],userInfo:{name:"",gender:"",age:0,mobile:"",email:"",agree:!1}},methods:{kv_Ani:function(){var e=.3,t=new TimelineMax({delay:1.2});t.set(".kv .warning",{opacity:1}),t.set(".kv .warning",{opacity:.4},"+=0.1"),t.set(".kv .warning",{opacity:1},"+=0.1"),t.set(".kv .warning",{opacity:.4},"+=0.1"),t.to(".kv .fogleft",3*e,{x:-150,scale:1.5,opacity:0},"+=0.3"),t.to(".kv .fogright",3*e,{x:150,scale:1.5,opacity:0},"-=0.9"),t.from(".kv .slogn",e,{x:-50,opacity:0}),t.from(".kv .desc",e,{x:-50,opacity:0}),t.from(".kv .acbtn",e,{x:-50,opacity:0}),t.to(".kv .warning",.6,{opacity:1}),t.set(".kv .car",{className:"+=car-active"},"-=0.6"),t.set(".kv .underline",{className:"+=udline-active"}),t.set(".kv .warning",{className:"+=warning-active"})},game_Ani:function(){(new TimelineMax).to(".question .quebox",.3,{opacity:1})},createVideo:function(o,n,i){return new Promise(function(e){var t=document.createElement("video");t.src=o,t.autoplay=!1,t.muted=!0,t.volume=.3,t.setAttribute("playsinline",""),t.setAttribute("id",n),document.getElementById(i).appendChild(t),e()})},removeVideo:function(e){document.getElementById(e).remove()},play:function(e){var t=this;switch(t.videoPlay=!0,document.querySelectorAll("video")[1].style="transform: scale(0.3) translate(5%, -20%)",e){case 1:t.createVideo("static/toyota_video/video-lv2-out.mp4","video3","videoarea2"),t.createVideo("static/toyota_video/video-lv2-in.mp4","video4","videoarea2"),document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,setTimeout(function(){t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.nextPage(1)},600)},600)};break;case 2:t.createVideo("static/toyota_video/video-lv3-out.mp4","video5","videoarea3"),t.createVideo("static/toyota_video/video-lv3-in.mp4","video6","videoarea3"),document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,setTimeout(function(){t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.nextPage(2)},600)},600)};break;case 3:t.createVideo("static/toyota_video/video-lv4-out.mp4","video7","videoarea4"),t.createVideo("static/toyota_video/video-lv4-in.mp4","video8","videoarea4"),document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,setTimeout(function(){t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.nextPage(3)},600)},600)};break;case 4:t.createVideo("static/toyota_video/video-lv5-out.mp4","video9","videoarea5"),t.createVideo("static/toyota_video/video-lv5-in.mp4","video10","videoarea5"),document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,setTimeout(function(){t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.nextPage(4)},600)},600)};break;case 5:t.createVideo("static/toyota_video/video-lv6-out.mp4","video11","videoarea6"),t.createVideo("static/toyota_video/video-lv6-in.mp4","video12","videoarea6"),document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,setTimeout(function(){t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.nextPage(5)},600)},600)};break;case 6:document.querySelectorAll("video")[1].onended=function(){t.videoPlay=!1,t.loading=!0,t.loadPage="poploading",setTimeout(function(){t.loading=!1,t.loadPage=""},1e3),t.page="result",t.step="",t.question="",t.removeOrientation(),0==t.userScore&&(t.userScore=1),t.userScore<=3?t.resultMan="images/result-man-low.png":t.resultMan="images/result-man-high.png",t.result=t.resultArr[t.userScore-1][Math.floor(2*Math.random())]}}},introPlay:function(t){var o=this;return new Promise(function(e){document.getElementById(t).oncanplay=function(){o.popup=!1,o.popPage=""},document.getElementById(t).oncanplay(),e()})},canPlay:function(a,r){var c=this;return new Promise(function(e){var t=!1,o=!1,n=new Promise(function(e){document.getElementById(a).oncanplay=function(){t=!0},document.getElementById(a).oncanplay(),e()}),i=new Promise(function(e){document.getElementById(r).oncanplay=function(){o=!0},document.getElementById(r).oncanplay(),e()});Promise.all([n,i]).then(function(){t&&o&&(c.loading=!1,c.loadPage="")}),e()})},nextPage:function(e){var t=this;switch(e){case 1:t.removeVideo("videoarea"),t.question="que2",setTimeout(function(){t.canPlay("video3","video4")},1e3);break;case 2:t.removeVideo("videoarea2"),t.question="que3",setTimeout(function(){t.canPlay("video5","video6"),t.gameDrag(3)},1e3);break;case 3:t.removeVideo("videoarea3"),t.question="que4",setTimeout(function(){t.canPlay("video7","video8")},1e3);break;case 4:t.removeVideo("videoarea4"),t.question="que5",setTimeout(function(){t.gameDrag(5),t.canPlay("video9","video10")},1e3);break;case 5:t.removeVideo("videoarea5"),t.question="que6",setTimeout(function(){t.gameDrag(6),t.canPlay("video11","video12")},1e3)}},onOrientationchange:function(){var e=this;if(180===window.orientation||0===window.orientation){e.alertPopup=!0,e.alertPage="alert",e.toggleFullScreen(!1);for(var t=0;t<document.querySelectorAll("video").length;t++)document.querySelectorAll("video")[t].pause()}if((90===window.orientation||-90===window.orientation)&&(e.alertPopup=!1,(e.alertPage="")==!e.question&&e.toggleFullScreen(!0),document.getElementsByClassName("levelpage")[0].scrollTo(0,10),window.scrollTo(0,10),e.videoIntro&&document.getElementById("video_intro").play(),e.videoPlay))for(var o=0;o<2;o++)document.querySelectorAll("video")[o].play()},checkOrientation:function(){window.addEventListener("orientationchange",this.onOrientationchange,!1)},removeOrientation:function(){window.removeEventListener("orientationchange",this.onOrientationchange,!1)},toggleFullScreen:function(e){var t=window.document,o=t.documentElement,n=o.requestFullscreen||o.mozRequestFullScreen||o.webkitRequestFullScreen||o.msRequestFullscreen,i=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;e?t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement||n.call(o):i.call(t)},togame:function(){var e=this;e.alertPopup=!0,e.alertPage="alert",setTimeout(function(){e.popup=!0,e.popPage="save",e.page="game",e.step="ready",e.checkOrientation(),setTimeout(function(){e.createVideo("static/toyota_video/video-intro.mp4","video_intro","videoarea0")},50)},600)},gameStrat:function(){new Date(2020,6,29,17,59,59)<new Date?this.checkFb():(alert("活動將於18:00正式開始"),location.reload())},checkFb:function(){var e=navigator.userAgent;navigator.userAgent.toLowerCase();-1<e.indexOf("FB")?this.fbStart():this.togame()},savebtn:function(){var e=this,t=[];if(0==e.savecheck.q1||0==e.savecheck.q2||0==e.savecheck.q3)e.popup=!0,e.popPage="fail";else if(2==e.savecheck.q1&&2==e.savecheck.q2&&2==e.savecheck.q3)e.popup=!1,e.popPage="",e.page="game",e.step="ready",setTimeout(function(){e.gameReady()},50);else{switch(1==e.savecheck.q1&&t.push(e.savecheck.q1),1==e.savecheck.q2&&t.push(e.savecheck.q2),1==e.savecheck.q3&&t.push(e.savecheck.q3),t.length){case 1:1==e.savecheck.q1&&(e.warning=1),1==e.savecheck.q2&&(e.warning=2),1==e.savecheck.q3&&(e.warning=3);break;case 2:case 3:e.warning=4}e.popPage="warning"}},failbtn:function(){this.popup=!0,this.popPage="save"},warningbtn:function(){var e=this;e.popup=!1,e.popPage="",setTimeout(function(){e.gameReady()},50)},gameReady:function(){var e=this;Draggable.create("#car",{type:"x",edgeResistance:1,dragResistance:.6,bounds:".carbox",inertia:!0,onDragStart:function(){$(".ready .car").addClass("car-active"),$(".ready .arr").css("display","none"),document.getElementById("video_intro").muted=!1},onClick:function(){},onDragEnd:function(){$(".ready .car").addClass("car-run"),e.introPlay("video_intro").then(function(){document.getElementById("video_intro").pause()}),setTimeout(function(){e.step="start",setTimeout(function(){e.gameLevel_1(),-1<navigator.userAgent.toLowerCase().indexOf("fb")||e.toggleFullScreen(!0)},300)},1200)}})},gameLevel_1:function(){var e=this;e.createVideo("static/toyota_video/video-lv1-out.mp4","video1","videoarea"),e.createVideo("static/toyota_video/video-lv1-in.mp4","vidoe2","videoarea"),setTimeout(function(){document.getElementById("video_intro").play(),e.videoIntro=!0},700),document.getElementById("video_intro").onended=function(){e.videoIntro=!1,e.removeVideo("videoarea0"),setTimeout(function(){e.question="que1",setTimeout(function(){e.game_Ani(),e.gameDrag(1),setTimeout(function(){},100)},600)},600)}},gameDrag:function(e){var t,o=this;Draggable.create("#rotabox",{type:"rotation",inertia:!0,throwProps:!0,liveSnap:{rotation:function(e){return t=72*Math.round(e/72),72*Math.round(e/72)}},onDrag:function(){t%360==72||t%360==-288?$(".sel1 p").css("color","#ffffff"):$(".sel1 p").css("color","#707070"),t%360==144||t%360==-216?$(".sel2 p").css("color","#ffffff"):$(".sel2 p").css("color","#707070"),t%360==216||t%360==-144?$(".sel3 p").css("color","#ffffff"):$(".sel3 p").css("color","#707070")},onDragEnd:function(){1==e&&(o.gameAns.txt="遭遇濕滑陡坡時，應選擇",o.gameAns.keyword="L4低速四輪傳動",t%360!=216&&t%360!=-144||(o.popup=!0,o.question="",o.popPage="correct",o.userScore+=1,setTimeout(function(){o.correctBtn(1)},50)),t%360!=72&&t%360!=144&&t%360!=-288&&t%360!=-216||(o.popup=!0,o.question="",o.popPage="error",setTimeout(function(){o.errorBtn(1)},50))),3==e&&(o.gameAns.txt="輪胎陷入崎嶇路面時，應選擇",o.gameAns.keyword="「L4低速四輪傳動」",t%360!=216&&t%360!=-144||(o.popup=!0,o.question="",o.popPage="correct",o.userScore+=1,setTimeout(function(){o.correctBtn(3)},50)),t%360!=72&&t%360!=144&&t%360!=-288&&t%360!=-216||(o.popup=!0,o.question="",o.popPage="error",setTimeout(function(){o.errorBtn(3)},50))),5==e&&(o.gameAns.txt="在沙地高速行進時，應選擇",o.gameAns.keyword="「H4 四輪高速傳動」",t%360!=144&&t%360!=-216||(o.popup=!0,o.question="",o.popPage="correct",o.userScore+=1,setTimeout(function(){o.correctBtn(5)},50)),t%360!=72&&t%360!=216&&t%360!=-216&&t%360!=-144||(o.popup=!0,o.question="",o.popPage="error",setTimeout(function(){o.errorBtn(5)},50))),6==e&&(o.gameAns.txt="在沙坑360度甩尾，應選擇",o.gameAns.keyword="「H2 高速二輪傳動」",t%360!=72&&t%360!=-288||(o.popup=!0,o.question="",o.popPage="correct",o.userScore+=1,setTimeout(function(){o.correctBtn(6)},50)),t%360!=144&&t%360!=216&&t%360!=-216&&t%360!=-144||(o.popup=!0,o.question="",o.popPage="error",setTimeout(function(){o.errorBtn(6)},50)))}})},listbtn:function(e){var t=this;"que2"==t.question&&(t.gameAns.txt="欲確認是否有人或障礙物，應選擇",t.gameAns.keyword="「PVM環景影像輔助系統」",t.popup=!0,t.question="",4==e?(t.userScore+=1,t.popPage="correct",setTimeout(function(){t.correctBtn(2)},50)):(t.popPage="error",setTimeout(function(){t.errorBtn(2)},50))),"que4"==t.question&&(t.gameAns.txt="後輪懸空時，應選擇",t.gameAns.keyword="「LOCK 後軸差速器鎖定」",t.popup=!0,t.question="",1==e?(t.userScore+=1,t.popPage="correct",setTimeout(function(){t.correctBtn(4)},50)):(t.popPage="error",setTimeout(function(){t.errorBtn(4)},50)))},correctBtn:function(t){var o=this;$(".correct .btn").click(function(){o.popup=!1,o.popPage="",setTimeout(function(){for(var e=0;e<document.querySelectorAll("video").length;e++)document.querySelectorAll("video")[e].play();document.querySelectorAll("video")[0].muted=!1,o.play(t)},600)})},errorBtn:function(t){var o=this;$(".error .btn").click(function(){o.popup=!1,o.popPage="",setTimeout(function(){for(var e=0;e<document.querySelectorAll("video").length;e++)document.querySelectorAll("video")[e].play();document.querySelectorAll("video")[0].muted=!1,o.play(t)},600)})},fbShare:function(){var e=this.result.fbLink;if(3!=this.projectStatus)return this.page="info",window.open("https://www.facebook.com/sharer/sharer.php?u="+e+"&hashtag=%23Hilux壯遊行"),!1;window.open("https://www.facebook.com/sharer/sharer.php?u="+e+"&hashtag=%23Hilux壯遊行"),window.location.href="carowner.html"},infoSavedata:function(){var t=this,e=new FormData;return e.append("mobile",t.userInfo.mobile),e.append("name",t.userInfo.name),e.append("age",t.userInfo.age),e.append("gender",t.userInfo.gender),e.append("email",t.userInfo.email),e.append("reCaptcha",t.reCaptcha),$.ajax({url:"".concat(friendo_url,"data"),headers:{Authorization:"Bearer "+t.mainToken},data:e,method:"POST",processData:!1,contentType:!1}).done(function(e){t.loading=!1,t.loadPage="",t.popup=!0,t.popPage="done"})},userInfobtn:function(){var e=this;if(!e.loading){if(""==e.userInfo.name)return void alert("請輸入姓名");if(""==e.userInfo.gender)return void alert("請勾選性別");if(0==e.userInfo.age)return void alert("請選擇年齡");if(""==e.userInfo.mobile||!e.userInfo.mobile.match(/^09[0-9]{8}$/))return void alert("手機號碼 格式錯誤");if(""==e.userInfo.email||!e.userInfo.email.match(/^[A-Za-z0-9._-]+@[A-Za-z0-9.-]/))return void alert("email 格式錯誤");if(!e.userInfo.agree)return void alert("請勾選同意條款");e.loading=!0,e.loadPage="formloading",setTimeout(function(){e.loading=!1,e.loadPage="",e.popup=!0,e.popPage="done"},1500)}},creatAge:function(){for(var e=1;e<100;e++)this.agreeArr.push(e)},fbStart:function(){var e=this;document.querySelector("body").classList.add("fbweb"),e.alertPopup=!0,e.alertPage="oops",setTimeout(function(){e.popup=!0,e.popPage="save",e.page="game",e.step="ready",setTimeout(function(){e.createVideo("static/toyota_video/video-intro.mp4","video_intro","videoarea0")},300)},300)}},created:function(){},mounted:function(){this.checkBrower("index"),this.kv_Ani()}});