"use strict";var index_view=new Vue({el:"#app",data:{memberInfo:{monsterId:"",isReached:null,cellNO:"",name:"",actId:0},memberId:"",code:"",score:0,hasResultRecord:!1,clickCun:0,isReached:!1,isNewscore:!1,time:{min:0,sec:0,milli:0},besttime:{min:0,sec:0,milli:0},bestScore:0,userRank:0,rank:{},ranking:[],rankArr:[],retry:!1,pages:"kv",lottiepath:["./static/lottie/QM_CNY_2.json","./static/lottie/QM_CNY_3.json"][Math.floor(2*Math.random())],lottie:1,randomtxt:"",recun:0},methods:{cunClick:function(e){e.preventDefault(),this.clickCun+=1;var t=document.querySelector(".clock"),e=document.querySelector(".progress");t.style.left=7+.77*this.clickCun+"%",e.style.width=.84*this.clickCun+"%",33<=this.clickCun&&(this.lottie=2),66<=this.clickCun&&(this.lottie=3),99<=this.clickCun&&(this.clickCun=100)},reciprocal:function(){var e=this;e.recun=3,setTimeout(function(){e.recun=2,setTimeout(function(){e.recun=1,setTimeout(function(){e.gameStart()},1e3)},1e3)},1e3)},randomWord:function(){var e=this,t=["再讓我多睡一下","ZZZ...","呼...呼...","好睏呀......","真的好累......","好冷好想睡......"];e.randomtxt=t[Math.floor(Math.random()*t.length)];var o=setInterval(function(){e.randomtxt=t[Math.floor(Math.random()*t.length)],33<=e.clickCun&&(t=["怎麼一直睡不好","不要吵啦.....","好癢呀！","是什麼東西一直嗡嗡叫......","還不想起床......","再給我五分鐘啦！"]),66<=e.clickCun&&(t=["咦...到底誰在吵我睡覺...","叫不醒我就要繼續睡囉～","以為這樣就能叫醒我嗎..."]),100<=e.clickCun&&(clearInterval(o),t=["哇嗚~喚醒Q摸年獸","恭喜發財~牛來運轉","可愛的Q摸送你一個紅包"],e.randomtxt=t[Math.floor(Math.random()*t.length)])},3e3)},gameStart:function(){var e=this;e.popup=!1,e.popPage="";var t=document.querySelector(".clickarea");t.addEventListener("touchstart",e.cunClick,!1),e.randomWord();var o=setInterval(function(){e.score+=3,e.time.milli=parseInt(e.score.toString().slice(-2)),e.time.sec=parseInt(e.score/100)-60*parseInt(e.score/6e3),e.time.min=parseInt(e.score/6e3),e.time.milli<10?e.time.milli="0"+e.time.milli:e.time.milli=""+e.time.milli,e.time.sec<10?e.time.sec="0"+e.time.sec:e.time.sec=""+e.time.sec,99<=e.clickCun&&(clearInterval(o),t.removeEventListener("touchstart",e.cunClick,!1),e.gaEvent("遊戲成功"),e.hasResultRecord=!0,document.querySelector(".gamemonster svg").remove(),lottie.loadAnimation({wrapper:document.querySelector(".gamemonster"),animType:"svg",loop:!1,path:"./static/lottie/QM_CNY_5.json"}).addEventListener("complete",function(){e.pages="sucagain",e.$nextTick(function(){lottie.loadAnimation({wrapper:document.querySelector(".monster"),animType:"svg",loop:!0,path:"./static/lottie/QM_CNY_5.json"})})})),3<=parseInt(e.score/6e3)&&(clearInterval(o),t.removeEventListener("touchstart",e.cunClick,!1),e.gaEvent("遊戲失敗"),e.hasResultRecord=!1,e.pages="fail",e.$nextTick(function(){lottie.loadAnimation({wrapper:document.querySelector(".monster"),animType:"svg",loop:!0,path:["./static/lottie/QM_CNY_2.json","./static/lottie/QM_CNY_3.json"][Math.floor(2*Math.random())]})}))},30)},gameRetry:function(){var e=this;e.score=0,e.clickCun=0,e.time.min=0,e.time.sec=0,e.time.milli=0,e.recun=0,e.beforeGame()},postMember:function(){var o=this,e={monsterId:o.memberInfo.monsterId,isReached:o.memberInfo.isReached,mobile:o.memberInfo.cellNO,name:o.memberInfo.name,actId:o.memberInfo.actId};return console.log(e),new Promise(function(t){o.projApi.post("Monster2021CNY/member",e).then(function(e){console.log("postMember: ",e),o.memberId=e.data.memberId,t()}).catch(function(e){console.log("postMembererr: ",e)})})},beforeGame:function(){this.togame()},gameRecord:function(){var o=this,e={memberId:o.memberId,code:o.code,score:o.score,hasResultRecord:o.hasResultRecord};return new Promise(function(t){o.projApi.post("Monster2021CNY/game",e).then(function(e){console.log("gameRecord: ",e),o.isReached=e.data.isReached,o.isNewscore=e.data.isNewScore,o.bestScore=e.data.bestScore,o.besttime.min=""+parseInt(o.bestScore/6e3),o.besttime.sec=parseInt(o.bestScore/100),o.besttime.sec<10?o.besttime.sec="0"+o.besttime.sec:o.besttime.sec=""+o.besttime.sec,o.besttime.milli=parseInt(o.bestScore.toString().slice(-2)),o.besttime.milli<10?o.besttime.milli="0"+o.besttime.milli:o.besttime.milli=""+o.besttime.milli,t()})})},getRanking:function(){this.pages="ranking";for(var e=0;e<10;e++){var t={};t.name="aaa"+e,t.mobile="09XXXXXXX"+e,t.rank=e+1,t.milli="0"+e,t.sec="0"+e,t.min="0",this.rankArr.push(t)}},postGivebox:function(){var t=this;t.popup=!0,t.popPage="loading";var e={memberId:t.memberId};t.projApi.post("Monster2021CNY/giveBox",e).then(function(e){console.log("postGivebox: ",e),200==e.code?(t.popup=!1,t.popPage="",/(iPhone|iPad|iPod|iOS|iPhone Simulator)/i.test(navigator.userAgent)?window.webkit.messageHandlers.doStuffMessageHandler.postMessage({url:"http://official.friendo.com.tw/",event:1,btn_text:"去首頁",act_transfer:{page_no:"A01",url:"https://goo.gl/forms/hu7YrYCYYI4D57Nn2",title:"",act_id:0}}):/(Android)/i.test(navigator.userAgent)&&qmonster.transfer('{"url": "http://official.friendo.com.tw/","event": 1,"btn_text": "去首頁","act_transfer": {"page_no": "A01","url":"https://goo.gl/forms/hu7YrYCYYI4D57Nn2","title": "","act_id": 0}}')):(alert("哎呀！回到怪獸的通道好像故障了！請拉掉APP並重新開啟，就可以成功領獎囉！"),t.popup=!1,t.popPage="")}).catch(function(e){console.log("postGiveboxErr: ",e),alert("哎呀！回到怪獸的通道好像故障了！請拉掉APP並重新開啟，就可以成功領獎囉！"),t.popup=!1,t.popPage=""})},togame:function(){var e=this;e.popup=!0,e.popPage="gamealert",e.pages="game",e.$nextTick(function(){lottie.loadAnimation({wrapper:document.querySelector(".gamemonster"),animType:"svg",loop:!0,path:e.lottiepath})})},kvAni:function(){var e=.3,t=gsap.timeline({duration:1});t.from(".kv .kvslogn",{duration:.6,y:50,opacity:0}),t.from(".kv .kvtxt",{duration:.6,y:50,opacity:0},"-=0.3"),t.from(".kv .kvmonster",{duration:e,y:50,opacity:0}),t.from(".kv .btnarea",{duration:e,y:50,opacity:0}),t.from(".kv .deco",{duration:.6,opacity:0},"-=0.3"),t.from(".kv .btnreadme",{duration:.6,opacity:0},"-=0.6")},scrolltoUser:function(){var e=document.querySelector(".highline"),e=e.offsetTop-e.offsetHeight;document.querySelector(".ranking ul").scrollTo(0,e)}},watch:{},created:function(){var e=this;e.memberInfo.monsterId=findGetParameter("member_id"),e.memberInfo.isReached="false"!==findGetParameter("is_reached"),e.memberInfo.cellNO=findGetParameter("cell_no"),e.memberInfo.name=findGetParameter("name"),e.memberInfo.actId=parseInt(findGetParameter("act_id"))},mounted:function(){"kv"==this.pages&&lottie.loadAnimation({wrapper:document.querySelector(".kvmonster"),animType:"svg",loop:!0,path:"./static/lottie/QM_CNY_1.json"}),this.kvAni()}});