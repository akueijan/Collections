"use strict";var index_view=new Vue({el:"#app",data:{faceData:{}},methods:{checkUpimg:function(){var i=document.querySelector("input"),s=document.querySelector(".preview");i.addEventListener("change",function(){for(;s.firstChild;)s.removeChild(s.firstChild);var e=i.files;if(0===e.length){var t=document.createElement("p");t.textContent="No files currently selected for upload",s.appendChild(t)}else{var n=document.createElement("ol");s.appendChild(n);for(var a=0;a<e.length;a++){var r=document.createElement("li"),t=document.createElement("p");if(l(e[a])){t.textContent="File name "+e[a].name+", file size "+y(e[a].size)+".";var o=document.createElement("img");o.setAttribute("id","blah"),o.src=window.URL.createObjectURL(e[a]),r.appendChild(o),r.appendChild(t)}else t.textContent="File name "+e[a].name+": Not a valid file type. Update your selection.",r.appendChild(t);n.appendChild(r)}}}),i.style.opacity=0;var n=["image/jpeg","image/pjpeg","image/png"];function l(e){for(var t=0;t<n.length;t++)if(e.type===n[t])return!0;return!1}function y(e){return e<1024?e+"bytes":1024<e&&e<1048576?(e/1024).toFixed(1)+"KB":1048576<e?(e/1048576).toFixed(1)+"MB":void 0}},readURL:function(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#blah").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}},processImage:function(){var t=this;$.ajax({url:"https://eastasia.api.cognitive.microsoft.com/face/v1.0/detect?"+$.param({returnFaceId:"true",returnFaceLandmarks:"true",returnFaceAttributes:"age,gender,headPose,smile,facialHair,glasses,emotion,hair,makeup,occlusion,accessories,blur,exposure,noise"}),beforeSend:function(e){e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Ocp-Apim-Subscription-Key","a33915a3b926473da34474fdca48f3eb")},type:"POST",data:'{"url": "http://data.whicdn.com/images/159997508/large.jpg"}'}).done(function(e){console.log(e),t.faceData=e,$("#responseTextArea").val(JSON.stringify(e,null,2))}).fail(function(e,t,n){var a=""===n?"Error. ":n+" ("+e.status+"): ";a+=""===e.responseText?"":jQuery.parseJSON(e.responseText).message?jQuery.parseJSON(e.responseText).message:jQuery.parseJSON(e.responseText).error.message,alert(a)})},dataURItoBlob:function(e){var t;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return new Blob([a],{type:n})},loadcanvas:function(){var s=document.getElementById("loadcanvas"),l=s.getContext("2d"),y=new Image;y.src="http://data.whicdn.com/images/159997508/large.jpg",y.onload=function(){var e=s.width,t=s.height,n=e,a=t,r=s.width/2-n/2,o=s.height/2-a/2,i={x:e/2,y:t/2};l.save(),l.translate(i.x,i.y),l.translate(-i.x,-i.y),l.drawImage(y,0,0,e,t,r,o,n,a)},this.cutImg(can,faceRectangle.x,faceRectangle.y)},drawline:function(){var e=this,t=document.getElementById("loadcanvas");if(t.getContext){var n=t.getContext("2d");n.strokeStyle="#ffffff",n.lineWidth=2;var a=e.faceData[0].faceLandmarks;n.beginPath(),n.lineCap="round",n.lineJoin="round",n.save();var r=[{x:a.eyebrowLeftOuter.x,y:a.eyebrowLeftOuter.y},{x:a.eyebrowLeftInner.x,y:a.eyebrowLeftInner.y}];e.lineAni(r);var o=[{x:a.eyebrowRightOuter.x,y:a.eyebrowRightOuter.y},{x:a.eyebrowRightInner.x,y:a.eyebrowRightInner.y}];e.lineAni(o);var i=[{x:a.eyeLeftTop.x,y:a.eyeLeftTop.y},{x:a.eyeLeftOuter.x,y:a.eyeLeftOuter.y},{x:a.eyeLeftBottom.x,y:a.eyeLeftBottom.y},{x:a.eyeLeftInner.x,y:a.eyeLeftInner.y},{x:a.eyeLeftTop.x,y:a.eyeLeftTop.y}];e.lineAni(i);var s=[{x:a.eyeRightTop.x,y:a.eyeRightTop.y},{x:a.eyeRightOuter.x,y:a.eyeRightOuter.y},{x:a.eyeRightBottom.x,y:a.eyeRightBottom.y},{x:a.eyeRightInner.x,y:a.eyeRightInner.y},{x:a.eyeRightTop.x,y:a.eyeRightTop.y}];e.lineAni(s);var l=[{x:a.noseRootLeft.x,y:a.noseRootLeft.y},{x:a.noseLeftAlarTop.x,y:a.noseLeftAlarTop.y},{x:a.noseLeftAlarOutTip.x,y:a.noseLeftAlarOutTip.y},{x:a.noseTip.x,y:a.noseTip.y},{x:a.noseRightAlarOutTip.x,y:a.noseRightAlarOutTip.y},{x:a.noseRightAlarTop.x,y:a.noseRightAlarTop.y},{x:a.noseRootRight.x,y:a.noseRootRight.y}];e.lineAni(l),window.requestAnimationFrame(e.drawline)}},drawRowline:function(e,t,n,a,r){var o=0,i=0,s=document.getElementById("loadcanvas").getContext("2d");var l=setInterval(function(){o<=r&&(o+=r/10,i+=.1,s.moveTo(e,t),s.lineTo(e+(n-e)*i,t+(a-t)*i),s.stroke())},100);setTimeout(function(){clearInterval(l)},2e3)},lineAni:function(t){var n=document.getElementById("loadcanvas").getContext("2d");n.lineCap="round";var a=1,r=[];t.forEach(function(e){r.push(e)}),n.lineWidth=1;t=function(e){for(var t=[],n=1;n<e.length;n++)for(var a=e[n-1],r=e[n],o=r.x-a.x,i=r.y-a.y,s=0;s<100;s++){var l=a.x+o*s/100,y=a.y+i*s/100;t.push({x:l,y:y})}return t}(r);!function e(){a<t.length-1&&requestAnimationFrame(e);n.beginPath();n.moveTo(t[a-1].x,t[a-1].y);n.lineTo(t[a].x,t[a].y);n.stroke();a+=5}()},cutImg:function(e,t,n){var a=canvas.getContext("2d").getImageData(t.x,t.y,n.x,n.y),r=document.createElement("canvas");return r.width=n.x-t.x,r.height=n.y-t.y,r.getContext("2d").putImageData(a,0,0),r}},mounted:function(){this.checkUpimg()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImluZGV4X3ZpZXciLCJWdWUiLCJlbCIsImZhY2VEYXRhIiwiY2hlY2tVcGltZyIsIm1ldGhvZHMiLCJpbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByZXZpZXciLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJjdXJGaWxlcyIsInBhcmEiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwibGlzdCIsImNyZWF0ZUVsZW1lbnQiLCJpIiwibGVuZ3RoIiwibGlzdEl0ZW0iLCJ2YWxpZEZpbGVUeXBlIiwiaW1hZ2UiLCJzZXRBdHRyaWJ1dGUiLCJuYW1lIiwicmV0dXJuRmlsZVNpemUiLCJzaXplIiwid2luZG93IiwiVVJMIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZpbGVUeXBlcyIsImZpbGUiLCJ0eXBlIiwibnVtYmVyIiwidG9GaXhlZCIsInJlYWRlciIsIiQiLCJmaWxlcyIsImF0dHIiLCJlIiwidGFyZ2V0IiwiRmlsZVJlYWRlciIsInJlYWRBc0RhdGFVUkwiLCJyZXN1bHQiLCJwcm9jZXNzSW1hZ2UiLCJ2bSIsInRoaXMiLCJ4aHJPYmoiLCJzZXRSZXF1ZXN0SGVhZGVyIiwicmV0dXJuRmFjZUlkIiwicmV0dXJuRmFjZUxhbmRtYXJrcyIsInJldHVybkZhY2VBdHRyaWJ1dGVzIiwiZG9uZSIsImVycm9yU3RyaW5nIiwiYWxlcnQiLCJkYXRhIiwidmFsIiwiSlNPTiIsInN0cmluZ2lmeSIsImZhaWwiLCJkYXRhVVJJIiwic3BsaXQiLCJ0ZXh0U3RhdHVzIiwiZXJyb3JUaHJvd24iLCJtaW1lU3RyaW5nIiwic3RhdHVzIiwianFYSFIiLCJyZXNwb25zZVRleHQiLCJqUXVlcnkiLCJwYXJzZUpTT04iLCJtZXNzYWdlIiwiVWludDhBcnJheSIsImJ5dGVTdHJpbmciLCJlcnJvciIsImlhIiwiZGF0YVVSSXRvQmxvYiIsImxvYWRjYW52YXMiLCJpbmRleE9mIiwiYXRvYiIsImNhbnZhcyIsImdldENvbnRleHQiLCJpbWFnZU9iaiIsInNvdXJjZVgiLCJzb3VyY2VZIiwic291cmNlV2lkdGgiLCJkZXN0SGVpZ2h0Iiwic291cmNlSGVpZ2h0IiwiY29udGV4dCIsInNhdmUiLCJnZXRFbGVtZW50QnlJZCIsInRyYW5zbGF0ZSIsInJlY3RDZW50ZXJQb2ludCIsIkltYWdlIiwiZHJhd0ltYWdlIiwib25sb2FkIiwid2lkdGgiLCJoZWlnaHQiLCJkZXN0WCIsImN0eCIsImRlc3RXaWR0aCIsInN0cm9rZVN0eWxlIiwieCIsInkiLCJkcmF3RmFjZSIsImxpbmVDYXAiLCJsaW5lSm9pbiIsImRlc3RZIiwiY3V0SW1nIiwiY2FuIiwiZmFjZVJlY3RhbmdsZSIsImV5ZWJyb3dMZWZ0SW5uZXIiLCJsaW5lQW5pIiwiZXllYnJvd0xlZnQiLCJmYWNlTGFuZG1hcmtzIiwiYmVnaW5QYXRoIiwiZXllYnJvd1JpZ2h0IiwiZXllYnJvd1JpZ2h0SW5uZXIiLCJleWVicm93TGVmdE91dGVyIiwiZXllTGVmdEJvdHRvbSIsImV5ZWJyb3dSaWdodE91dGVyIiwiZXllTGVmdElubmVyIiwiZXllTGVmdFRvcCIsImV5ZUxlZnQiLCJleWVSaWdodCIsImV5ZVJpZ2h0VG9wIiwiZXllUmlnaHRPdXRlciIsImV5ZVJpZ2h0Qm90dG9tIiwibm9zZUxlZnRBbGFyT3V0VGlwIiwibm9zZVRpcCIsIm5vc2VSaWdodEFsYXJUb3AiLCJub3NlUm9vdFJpZ2h0Iiwibm9zZSIsIm5vc2VSb290TGVmdCIsIm5vc2VMZWZ0QWxhclRvcCIsIm5vc2VSaWdodEFsYXJPdXRUaXAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJkcmF3bGluZSIsImRyYXdSb3dsaW5lIiwic3RhcnRYIiwidmVydGljZXMiLCJpTGVuIiwiZmxhZyIsImR5IiwiaiIsImludCIsImFuaW1hdGUiLCJ3YXlwb2ludHMiLCJwdXNoIiwibW92ZVRvIiwic3RhcnRZIiwibGluZVRvIiwiZW5kWCIsImVuZFkiLCJzdHJva2UiLCJzZXRUaW1lb3V0IiwidCIsInBvaW50cyIsImZvckVhY2giLCJvYmoiLCJuZXdDYW4iLCJiIiwibmV3Q3R4IiwicHV0SW1hZ2VEYXRhIiwiaW1hZ2VEYXRhIiwicHQwIiwicHQxIiwiZHgiLCJjYWxjV2F5cG9pbnRzIiwiYSIsImdldEltYWdlRGF0YSIsIm1vdW50ZWQiXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLFdBQWEsSUFBSUMsSUFBSSxDQUNyQkMsR0FBSSxPQURKRixLQUFBQSxDQUNJRyxTQURpQixJQUdqQkEsUUFBQUEsQ0FIaUJDLFdBR2pCRCxXQUVKRSxJQUFTQyxFQUFBQyxTQUFBQyxjQUFBLFNBQ0xKLEVBREtHLFNBQUFDLGNBQ1EsWUFDVEYsRUFBSUEsaUJBQWlCRSxTQTRCYkMsV0FDSCxLQUFBQSxFQUFBQyxZQURHRCxFQUFRRSxZQUFZRixFQUFRQyxZQUs1QixJQUFBRSxFQUFXTCxFQUFBQSxNQUNYTSxHQUFtQixJQUFuQkEsRUFBS0MsT0FBYyxDQUNuQkwsSUFBQUEsRUFBUU0sU0FBWUYsY0FBcEIsS0FISkEsRUFJT0MsWUFBQSx5Q0FDSEwsRUFBSU8sWUFBZ0JDLE9BQ3BCUixDQUNBLElBQUFPLEVBQVFFLFNBQVdOLGNBQVNPLE1BQzVCVixFQUFJVyxZQUFXYixHQUNmLElBQUEsSUFBSU0sRUFBQUEsRUFBT04sRUFBQUEsRUFBU1UsT0FBQUEsSUFBVCxDQUNYLElBQUFHLEVBQUdDLFNBQWNULGNBQWMsTUFDM0JDLEVBQUFBLFNBQUtDLGNBQWMsS0FDbkIsR0FBQU8sRUFBSUMsRUFBUWYsSUFBU1UsQ0FDckJLLEVBQUFBLFlBQU1DLGFBQWtCWCxFQUF4Qk0sR0FBQU0sS0FBQSxlQUFBQyxFQUFBYixFQUFBTSxHQUFBUSxNQUFBLElBQ0EsSUFBQUosRUFBQWYsU0FBQVUsY0FBQSxPQUNBSyxFQUFBQSxhQUFZSyxLQUFPQyxRQUVuQlIsRUFBQUEsSUFBQUEsT0FBU0wsSUFBQUEsZ0JBQVRILEVBQUFNLElBRUhFLEVBQU1MLFlBQUFPLEdBQ0hULEVBQUtDLFlBQUxELFFBQUFBLEVBQUtDLFlBQWMsYUFBZUYsRUFBU00sR0FBR00sS0FB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RUFBQTlELEVBQUF3QyxFQUFBQyxFQUFBLElBQ0FHLEVBQUFDLEtBQUEsQ0FDQTlDLEVBQUFBLEVBQ0FDLEVBQUFBLElBSUgsT0FBQTRDLEVBbkJPcUIsQ0FBQTVCLElBcEJBLFNBQVNNLElBQ0RVLEVBQUlDLEVBQU96SSxPQUFTLEdBQ3BCb0gsc0JBQXNCVSxHQUkxQi9DLEVBQUlnQixZQUNKaEIsRUFBSWtELE9BQU9RLEVBQU9ELEVBQUksR0FBR3RELEVBQUd1RCxFQUFPRCxFQUFJLEdBQUdyRCxHQUMxQ0osRUFBSW9ELE9BQU9NLEVBQU9ELEdBQUd0RCxFQUFHdUQsRUFBT0QsR0FBR3JELEdBQ2xDSixFQUFJdUQsU0FFSkUsR0FBRyxFQVVQVixJQVBKdEMsT0E3YUF4RyxTQTZhT3lHLEVBQUs0RCxFQUFHUixHQUVYLElBQ0lHLEVBRE1wRixPQUFPQyxXQUFXLE1BQ1J5RixhQUFhRCxFQUFFbkUsRUFBR21FLEVBQUVsRSxFQUFHMEQsRUFBRTNELEVBQUcyRCxFQUFFMUQsR0FDOUN5RCxFQUFTeEosU0FBU1UsY0FBYyxVQU9wQyxPQU5BOEksRUFBT2hFLE1BQVFpRSxFQUFFM0QsRUFBSW1FLEVBQUVuRSxFQUN2QjBELEVBQU8vRCxPQUFTZ0UsRUFBRTFELEVBQUlrRSxFQUFFbEUsRUFDWHlELEVBQU8vRSxXQUFXLE1BR3hCa0YsYUFBYUMsRUFBVyxFQUFHLEdBQzNCSixJQUdmVyxRQUFTLFdBQ0k1SCxLQUNOMUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaW5kZXhfdmlldyA9IG5ldyBWdWUoe1xyXG4gICAgZWw6IFwiI2FwcFwiLFxyXG4gICAgZGF0YToge1xyXG4gICAgICAgIGZhY2VEYXRhOiB7fSxcclxuICAgIH0sXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgICAgY2hlY2tVcGltZygpIHtcclxuICAgICAgICAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcclxuICAgICAgICAgICAgdmFyIHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJldmlldycpO1xyXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB1cGRhdGVJbWFnZURpc3BsYXkpO1xyXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS5vcGFjaXR5ID0gMDtcclxuICAgICAgICAgICAgdmFyIGZpbGVUeXBlcyA9IFtcclxuICAgICAgICAgICAgICAgICdpbWFnZS9qcGVnJyxcclxuICAgICAgICAgICAgICAgICdpbWFnZS9wanBlZycsXHJcbiAgICAgICAgICAgICAgICAnaW1hZ2UvcG5nJ1xyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZhbGlkRmlsZVR5cGUoZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGZpbGVUeXBlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGZpbGUudHlwZSA9PT0gZmlsZVR5cGVzW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJldHVybkZpbGVTaXplKG51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgaWYobnVtYmVyIDwgMTAyNCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudW1iZXIgKyAnYnl0ZXMnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKG51bWJlciA+IDEwMjQgJiYgbnVtYmVyIDwgMTA0ODU3Nikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAobnVtYmVyLzEwMjQpLnRvRml4ZWQoMSkgKyAnS0InO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKG51bWJlciA+IDEwNDg1NzYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG51bWJlci8xMDQ4NTc2KS50b0ZpeGVkKDEpICsgJ01CJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVJbWFnZURpc3BsYXkoKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZShwcmV2aWV3LmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3LnJlbW92ZUNoaWxkKHByZXZpZXcuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciBjdXJGaWxlcyA9IGlucHV0LmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgaWYoY3VyRmlsZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYS50ZXh0Q29udGVudCA9ICdObyBmaWxlcyBjdXJyZW50bHkgc2VsZWN0ZWQgZm9yIHVwbG9hZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlldy5hcHBlbmRDaGlsZChwYXJhKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXcuYXBwZW5kQ2hpbGQobGlzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGN1ckZpbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZih2YWxpZEZpbGVUeXBlKGN1ckZpbGVzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhLnRleHRDb250ZW50ID0gJ0ZpbGUgbmFtZSAnICsgY3VyRmlsZXNbaV0ubmFtZSArICcsIGZpbGUgc2l6ZSAnICsgcmV0dXJuRmlsZVNpemUoY3VyRmlsZXNbaV0uc2l6ZSkgKyAnLic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLFwiYmxhaFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JsYWgnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoY3VyRmlsZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5hcHBlbmRDaGlsZChpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtLmFwcGVuZENoaWxkKHBhcmEpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYS50ZXh0Q29udGVudCA9ICdGaWxlIG5hbWUgJyArIGN1ckZpbGVzW2ldLm5hbWUgKyAnOiBOb3QgYSB2YWxpZCBmaWxlIHR5cGUuIFVwZGF0ZSB5b3VyIHNlbGVjdGlvbi4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0SXRlbS5hcHBlbmRDaGlsZChwYXJhKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGxpc3RJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlYWRVUkwoaW5wdXQpIHtcclxuICAgICAgICAgICAgaWYgKGlucHV0LmZpbGVzICYmIGlucHV0LmZpbGVzWzBdKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICQoJyNibGFoJykuYXR0cignc3JjJywgZS50YXJnZXQucmVzdWx0KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcm9jZXNzSW1hZ2UoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25LZXkgPSBcImEzMzkxNWEzYjkyNjQ3M2RhMzQ0NzRmZGNhNDhmM2ViXCI7XHJcbiAgICAgICAgICAgIHZhciB1cmlCYXNlID0gXCJodHRwczovL2Vhc3Rhc2lhLmFwaS5jb2duaXRpdmUubWljcm9zb2Z0LmNvbS9mYWNlL3YxLjAvZGV0ZWN0XCI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFJlcXVlc3QgcGFyYW1ldGVycy5cclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgICAgIFwicmV0dXJuRmFjZUlkXCI6IFwidHJ1ZVwiLFxyXG4gICAgICAgICAgICAgICAgXCJyZXR1cm5GYWNlTGFuZG1hcmtzXCI6IFwidHJ1ZVwiLFxyXG4gICAgICAgICAgICAgICAgXCJyZXR1cm5GYWNlQXR0cmlidXRlc1wiOlxyXG4gICAgICAgICAgICAgICAgICAgIFwiYWdlLGdlbmRlcixoZWFkUG9zZSxzbWlsZSxmYWNpYWxIYWlyLGdsYXNzZXMsZW1vdGlvbixcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJoYWlyLG1ha2V1cCxvY2NsdXNpb24sYWNjZXNzb3JpZXMsYmx1cixleHBvc3VyZSxub2lzZVwiXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIERpc3BsYXkgdGhlIGltYWdlLlxyXG4gICAgICAgICAgICAvLyB2YXIgcmVnID0gbmV3IFJlZ0V4cChcImRhdGE6aW1hZ2UvanBlZztiYXNlNjQsXCIpO1xyXG4gICAgICAgICAgICAvLyB2YXIgc291cmNlSW1hZ2VVcmwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJsYWhcIikuc3JjXHJcbiAgICAgICAgICAgIHZhciBzb3VyY2VJbWFnZVVybCA9IFwiaHR0cDovL2RhdGEud2hpY2RuLmNvbS9pbWFnZXMvMTU5OTk3NTA4L2xhcmdlLmpwZ1wiO1xyXG4gICAgICAgICAgICAvLyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NvdXJjZUltYWdlXCIpLnNyYyA9IHNvdXJjZUltYWdlVXJsO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAvLyBQZXJmb3JtIHRoZSBSRVNUIEFQSSBjYWxsLlxyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiB1cmlCYXNlICsgXCI/XCIgKyAkLnBhcmFtKHBhcmFtcyksXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IGhlYWRlcnMuXHJcbiAgICAgICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHJPYmope1xyXG4gICAgICAgICAgICAgICAgICAgIHhock9iai5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHhock9iai5zZXRSZXF1ZXN0SGVhZGVyKFwiT2NwLUFwaW0tU3Vic2NyaXB0aW9uLUtleVwiLCBzdWJzY3JpcHRpb25LZXkpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gUmVxdWVzdCBib2R5LlxyXG4gICAgICAgICAgICAgICAgZGF0YTogJ3tcInVybFwiOiAnICsgJ1wiJyArIHNvdXJjZUltYWdlVXJsICsgJ1wifScsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNob3cgZm9ybWF0dGVkIEpTT04gb24gd2VicGFnZS4gPT0+5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgIHZtLmZhY2VEYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICQoXCIjcmVzcG9uc2VUZXh0QXJlYVwiKS52YWwoSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpOyAvLyDos4fmlplqc29u5YyWXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgICAgLy8gRGlzcGxheSBlcnJvciBtZXNzYWdlLiA9PT7lpLHmlZdcclxuICAgICAgICAgICAgICAgIHZhciBlcnJvclN0cmluZyA9IChlcnJvclRocm93biA9PT0gXCJcIikgP1xyXG4gICAgICAgICAgICAgICAgICAgIFwiRXJyb3IuIFwiIDogZXJyb3JUaHJvd24gKyBcIiAoXCIgKyBqcVhIUi5zdGF0dXMgKyBcIik6IFwiO1xyXG4gICAgICAgICAgICAgICAgZXJyb3JTdHJpbmcgKz0gKGpxWEhSLnJlc3BvbnNlVGV4dCA9PT0gXCJcIikgP1xyXG4gICAgICAgICAgICAgICAgICAgIFwiXCIgOiAoalF1ZXJ5LnBhcnNlSlNPTihqcVhIUi5yZXNwb25zZVRleHQpLm1lc3NhZ2UpID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LnBhcnNlSlNPTihqcVhIUi5yZXNwb25zZVRleHQpLm1lc3NhZ2UgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5LnBhcnNlSlNPTihqcVhIUi5yZXNwb25zZVRleHQpLmVycm9yLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBhbGVydChlcnJvclN0cmluZyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YVVSSXRvQmxvYihkYXRhVVJJKSB7XHJcbiAgICAgICAgICAgIHZhciBieXRlU3RyaW5nO1xyXG4gICAgICAgICAgICBpZiAoZGF0YVVSSS5zcGxpdCgnLCcpWzBdLmluZGV4T2YoJ2Jhc2U2NCcpID49IDApXHJcbiAgICAgICAgICAgICAgICBieXRlU3RyaW5nID0gYXRvYihkYXRhVVJJLnNwbGl0KCcsJylbMV0pO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBieXRlU3RyaW5nID0gdW5lc2NhcGUoZGF0YVVSSS5zcGxpdCgnLCcpWzFdKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlcGFyYXRlIG91dCB0aGUgbWltZSBjb21wb25lbnRcclxuICAgICAgICAgICAgdmFyIG1pbWVTdHJpbmcgPSBkYXRhVVJJLnNwbGl0KCcsJylbMF0uc3BsaXQoJzonKVsxXS5zcGxpdCgnOycpWzBdO1xyXG5cclxuICAgICAgICAgICAgLy8gd3JpdGUgdGhlIGJ5dGVzIG9mIHRoZSBzdHJpbmcgdG8gYSB0eXBlZCBhcnJheVxyXG4gICAgICAgICAgICB2YXIgaWEgPSBuZXcgVWludDhBcnJheShieXRlU3RyaW5nLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZVN0cmluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWFbaV0gPSBieXRlU3RyaW5nLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYihbaWFdLCB7dHlwZTptaW1lU3RyaW5nfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsb2FkY2FudmFzKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2FkY2FudmFzXCIpO1xyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIHZhciBpbWFnZU9iaiA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBudWxsO1xyXG4gICAgICAgICAgICBpbWFnZU9iai5zcmMgPSBcImh0dHA6Ly9kYXRhLndoaWNkbi5jb20vaW1hZ2VzLzE1OTk5NzUwOC9sYXJnZS5qcGdcIjtcclxuICAgICAgICAgICAgaW1hZ2VPYmoub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGRyYXcgY3JvcHBlZCBpbWFnZVxyXG4gICAgICAgICAgICB2YXIgc291cmNlWCA9IDA7IC8v5bqn5qiZWFxyXG4gICAgICAgICAgICB2YXIgc291cmNlWSA9IDA7IC8v5bqn5qiZWVxyXG4gICAgICAgICAgICB2YXIgc291cmNlV2lkdGggPSBjYW52YXMud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBzb3VyY2VIZWlnaHQgPSBjYW52YXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICB2YXIgZGVzdFdpZHRoID0gc291cmNlV2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBkZXN0SGVpZ2h0ID0gc291cmNlSGVpZ2h0O1xyXG4gICAgICAgICAgICB2YXIgZGVzdFggPSBjYW52YXMud2lkdGggLyAyIC0gZGVzdFdpZHRoIC8gMjtcclxuICAgICAgICAgICAgdmFyIGRlc3RZID0gY2FudmFzLmhlaWdodCAvIDIgLSBkZXN0SGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgdmFyIHJlY3RDZW50ZXJQb2ludCA9IHt4OiBzb3VyY2VXaWR0aC8yLCB5OiBzb3VyY2VIZWlnaHQvMn07XHJcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShyZWN0Q2VudGVyUG9pbnQueCwgcmVjdENlbnRlclBvaW50LnkpOyAvL+S4reW/g+WumuS9jeioreWumlxyXG4gICAgICAgICAgICAvLyBjb250ZXh0LnJvdGF0ZSgxMCooTWF0aC5QSS8xODApKTsgLy/oqK3lrprml4vovYnop5LluqZcclxuICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoLXJlY3RDZW50ZXJQb2ludC54LCAtcmVjdENlbnRlclBvaW50LnkpOyAvL+S4reW/g+WumuS9jeioreWumlxyXG4gICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZU9iaiwgc291cmNlWCwgc291cmNlWSwgc291cmNlV2lkdGgsIHNvdXJjZUhlaWdodCwgZGVzdFgsIGRlc3RZLCBkZXN0V2lkdGgsIGRlc3RIZWlnaHQpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyBjdXRpbWcgLy9cclxuICAgICAgICAgICAgdm0uY3V0SW1nKGNhbixmYWNlUmVjdGFuZ2xlLngsZmFjZVJlY3RhbmdsZS55KVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZHJhd2xpbmUoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRjYW52YXNcIik7XHJcbiAgICAgICAgICAgIGlmIChjYW52YXMuZ2V0Q29udGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGU9XCIjZmZmZmZmXCI7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoPTI7XHJcbiAgICAgICAgICAgICAgICB2YXIgZHJhd0ZhY2UgPSB2bS5mYWNlRGF0YVswXS5mYWNlTGFuZG1hcmtzO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVDYXAgPSAncm91bmQnO1xyXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVKb2luID0gJ3JvdW5kJztcclxuICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAvLz09PeW3pueciT09PS8vXHJcbiAgICAgICAgICAgICAgICAvLz09PemcgOWFiOiZleeQhuaIkOS4gOWMhW9iaj09PS8vXHJcbiAgICAgICAgICAgICAgICB2YXIgZXllYnJvd0xlZnQgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZWJyb3dMZWZ0T3V0ZXIueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVicm93TGVmdE91dGVyLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVicm93TGVmdElubmVyLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6ZHJhd0ZhY2UuZXllYnJvd0xlZnRJbm5lci55XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgdm0ubGluZUFuaShleWVicm93TGVmdCk7XHJcbiAgICAgICAgICAgICAgICAvLyB2bS5kcmF3Um93bGluZShkcmF3RmFjZS5leWVicm93TGVmdE91dGVyLngsZHJhd0ZhY2UuZXllYnJvd0xlZnRPdXRlci55LGRyYXdGYWNlLmV5ZWJyb3dMZWZ0SW5uZXIueCxkcmF3RmFjZS5leWVicm93TGVmdElubmVyLnksTWF0aC5hYnMoZHJhd0ZhY2UuZXllYnJvd0xlZnRPdXRlci54LWRyYXdGYWNlLmV5ZWJyb3dMZWZ0SW5uZXIueCkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkcmF3RmFjZS5leWVicm93TGVmdE91dGVyLngsZHJhd0ZhY2UuZXllYnJvd0xlZnRPdXRlci55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5saW5lVG8oZHJhd0ZhY2UuZXllYnJvd0xlZnRJbm5lci54LGRyYXdGYWNlLmV5ZWJyb3dMZWZ0SW5uZXIueSk7XHJcbiAgICAgICAgICAgICAgICAvLz09PeWPs+eciT09PS8vXHJcbiAgICAgICAgICAgICAgICB2YXIgZXllYnJvd1JpZ2h0ID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVicm93UmlnaHRPdXRlci54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLmV5ZWJyb3dSaWdodE91dGVyLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVicm93UmlnaHRJbm5lci54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLmV5ZWJyb3dSaWdodElubmVyLnlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB2bS5saW5lQW5pKGV5ZWJyb3dSaWdodCk7XHJcbiAgICAgICAgICAgICAgICAvLyB2bS5kcmF3Um93bGluZShkcmF3RmFjZS5leWVicm93UmlnaHRPdXRlci54LGRyYXdGYWNlLmV5ZWJyb3dSaWdodE91dGVyLnksZHJhd0ZhY2UuZXllYnJvd1JpZ2h0SW5uZXIueCxkcmF3RmFjZS5leWVicm93UmlnaHRJbm5lci55LE1hdGguYWJzKGRyYXdGYWNlLmV5ZWJyb3dSaWdodE91dGVyLngtZHJhd0ZhY2UuZXllYnJvd1JpZ2h0SW5uZXIueCkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkcmF3RmFjZS5leWVicm93UmlnaHRPdXRlci54LGRyYXdGYWNlLmV5ZWJyb3dSaWdodE91dGVyLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5leWVicm93UmlnaHRJbm5lci54LGRyYXdGYWNlLmV5ZWJyb3dSaWdodElubmVyLnkpO1xyXG4gICAgICAgICAgICAgICAgLy89PT3lt6bnnLw9PT0vL1xyXG4gICAgICAgICAgICAgICAgdmFyIGV5ZUxlZnQgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZUxlZnRUb3AueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVMZWZ0VG9wLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVMZWZ0T3V0ZXIueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVMZWZ0T3V0ZXIueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZUxlZnRCb3R0b20ueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVMZWZ0Qm90dG9tLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVMZWZ0SW5uZXIueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVMZWZ0SW5uZXIueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZUxlZnRUb3AueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVMZWZ0VG9wLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgdm0ubGluZUFuaShleWVMZWZ0KTtcclxuICAgICAgICAgICAgICAgIC8vIHZtLmRyYXdSb3dsaW5lKGRyYXdGYWNlLmV5ZUxlZnRUb3AueCxkcmF3RmFjZS5leWVMZWZ0VG9wLnksZHJhd0ZhY2UuZXllTGVmdE91dGVyLngsZHJhd0ZhY2UuZXllTGVmdE91dGVyLnksTWF0aC5hYnMoZHJhd0ZhY2UuZXllTGVmdFRvcC54LWRyYXdGYWNlLmV5ZUxlZnRPdXRlci54KSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubW92ZVRvKGRyYXdGYWNlLmV5ZUxlZnRUb3AueCxkcmF3RmFjZS5leWVMZWZ0VG9wLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5leWVMZWZ0T3V0ZXIueCxkcmF3RmFjZS5leWVMZWZ0T3V0ZXIueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubGluZVRvKGRyYXdGYWNlLmV5ZUxlZnRCb3R0b20ueCxkcmF3RmFjZS5leWVMZWZ0Qm90dG9tLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5leWVMZWZ0SW5uZXIueCxkcmF3RmFjZS5leWVMZWZ0SW5uZXIueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAvLz09PeWPs+ecvD09PS8vXHJcbiAgICAgICAgICAgICAgICB2YXIgZXllUmlnaHQgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZVJpZ2h0VG9wLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6ZHJhd0ZhY2UuZXllUmlnaHRUb3AueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLmV5ZVJpZ2h0T3V0ZXIueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVSaWdodE91dGVyLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVSaWdodEJvdHRvbS54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLmV5ZVJpZ2h0Qm90dG9tLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5leWVSaWdodElubmVyLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6ZHJhd0ZhY2UuZXllUmlnaHRJbm5lci55XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6ZHJhd0ZhY2UuZXllUmlnaHRUb3AueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5leWVSaWdodFRvcC55XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgIHZtLmxpbmVBbmkoZXllUmlnaHQpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkcmF3RmFjZS5leWVSaWdodFRvcC54LGRyYXdGYWNlLmV5ZVJpZ2h0VG9wLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5leWVSaWdodE91dGVyLngsZHJhd0ZhY2UuZXllUmlnaHRPdXRlci55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5saW5lVG8oZHJhd0ZhY2UuZXllUmlnaHRCb3R0b20ueCxkcmF3RmFjZS5leWVSaWdodEJvdHRvbS55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5saW5lVG8oZHJhd0ZhY2UuZXllUmlnaHRJbm5lci54LGRyYXdGYWNlLmV5ZVJpZ2h0SW5uZXIueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAvLz09Pem8u+WtkD09PS8vXHJcbiAgICAgICAgICAgICAgICB2YXIgbm9zZSA9IFtcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6ZHJhd0ZhY2Uubm9zZVJvb3RMZWZ0LngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6ZHJhd0ZhY2Uubm9zZVJvb3RMZWZ0LnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5ub3NlTGVmdEFsYXJUb3AueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5ub3NlTGVmdEFsYXJUb3AueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLm5vc2VMZWZ0QWxhck91dFRpcC54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLm5vc2VMZWZ0QWxhck91dFRpcC55XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6ZHJhd0ZhY2Uubm9zZVRpcC54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLm5vc2VUaXAueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OmRyYXdGYWNlLm5vc2VSaWdodEFsYXJPdXRUaXAueCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTpkcmF3RmFjZS5ub3NlUmlnaHRBbGFyT3V0VGlwLnlcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDpkcmF3RmFjZS5ub3NlUmlnaHRBbGFyVG9wLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6ZHJhd0ZhY2Uubm9zZVJpZ2h0QWxhclRvcC55XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6ZHJhd0ZhY2Uubm9zZVJvb3RSaWdodC54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OmRyYXdGYWNlLm5vc2VSb290UmlnaHQueVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB2bS5saW5lQW5pKG5vc2UpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkcmF3RmFjZS5ub3NlUm9vdExlZnQueCxkcmF3RmFjZS5ub3NlUm9vdExlZnQueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubGluZVRvKGRyYXdGYWNlLm5vc2VMZWZ0QWxhclRvcC54LGRyYXdGYWNlLm5vc2VMZWZ0QWxhclRvcC55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5saW5lVG8oZHJhd0ZhY2Uubm9zZUxlZnRBbGFyT3V0VGlwLngsZHJhd0ZhY2Uubm9zZUxlZnRBbGFyT3V0VGlwLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5ub3NlVGlwLngsZHJhd0ZhY2Uubm9zZVRpcC55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5saW5lVG8oZHJhd0ZhY2Uubm9zZVJpZ2h0QWxhck91dFRpcC54LGRyYXdGYWNlLm5vc2VSaWdodEFsYXJPdXRUaXAueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubGluZVRvKGRyYXdGYWNlLm5vc2VSaWdodEFsYXJUb3AueCxkcmF3RmFjZS5ub3NlUmlnaHRBbGFyVG9wLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5ub3NlUm9vdFJpZ2h0LngsZHJhd0ZhY2Uubm9zZVJvb3RSaWdodC55KTtcclxuICAgICAgICAgICAgICAgIC8vIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIC8vPT095Zi05be0PT09Ly9cclxuICAgICAgICAgICAgICAgIC8vIHZhciBtb3V0aHVwID0gW1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgeDpkcmF3RmFjZS51cHBlckxpcFRvcC54LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB5OmRyYXdGYWNlLnVwcGVyTGlwVG9wLnlcclxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgeDpkcmF3RmFjZS5ub3NlTGVmdEFsYXJUb3AueCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgeTpkcmF3RmFjZS5ub3NlTGVmdEFsYXJUb3AueVxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB4OmRyYXdGYWNlLm5vc2VMZWZ0QWxhck91dFRpcC54LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB5OmRyYXdGYWNlLm5vc2VMZWZ0QWxhck91dFRpcC55XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSxcclxuICAgICAgICAgICAgICAgIC8vICAgICB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHg6ZHJhd0ZhY2Uubm9zZVRpcC54LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB5OmRyYXdGYWNlLm5vc2VUaXAueVxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB4OmRyYXdGYWNlLm5vc2VSaWdodEFsYXJPdXRUaXAueCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgeTpkcmF3RmFjZS5ub3NlUmlnaHRBbGFyT3V0VGlwLnlcclxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgeDpkcmF3RmFjZS5ub3NlUmlnaHRBbGFyVG9wLngsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHk6ZHJhd0ZhY2Uubm9zZVJpZ2h0QWxhclRvcC55XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSxcclxuICAgICAgICAgICAgICAgIC8vICAgICB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHg6ZHJhd0ZhY2Uubm9zZVJvb3RSaWdodC54LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB5OmRyYXdGYWNlLm5vc2VSb290UmlnaHQueVxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvLyBdXHJcbiAgICAgICAgICAgICAgICAvLyB2bS5saW5lQW5pKG1vdXRodXApO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkcmF3RmFjZS51cHBlckxpcFRvcC54LGRyYXdGYWNlLnVwcGVyTGlwVG9wLnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkcmF3RmFjZS5tb3V0aExlZnQueCxkcmF3RmFjZS5tb3V0aExlZnQueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubGluZVRvKGRyYXdGYWNlLnVuZGVyTGlwQm90dG9tLngsZHJhd0ZhY2UudW5kZXJMaXBCb3R0b20ueSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjdHgubGluZVRvKGRyYXdGYWNlLm1vdXRoUmlnaHQueCxkcmF3RmFjZS5tb3V0aFJpZ2h0LnkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgLy89PT3ntZDmnZ89PT0vL1xyXG4gICAgICAgICAgICAgICAgLy8gY3R4LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh2bS5kcmF3bGluZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRyYXdSb3dsaW5lKHN0YXJ0WCxzdGFydFksZW5kWCxlbmRZLGxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgaUxlbiA9IDA7XHJcbiAgICAgICAgICAgIHZhciBmbGFnID0gMDtcclxuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGNhbnZhc1wiKTtcclxuICAgICAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJvd0xpbmUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZihpTGVuIDw9IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlMZW4gKz0gbGVuZ3RoLzEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGZsYWcgKz0gMC4xO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHN0YXJ0WCxzdGFydFkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oc3RhcnRYICsgKGVuZFgtc3RhcnRYKSpmbGFnLCBzdGFydFkgKyAoZW5kWS1zdGFydFkpKmZsYWcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaW50ID0gc2V0SW50ZXJ2YWwocm93TGluZSwxMDApO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludCk7XHJcbiAgICAgICAgICAgIH0sMjAwMClcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLz09PT0955Wr57ea5YuV55WrPT09PT0vL1xyXG4gICAgICAgIGxpbmVBbmkocG9pbnRzKSB7XHJcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvYWRjYW52YXNcIik7XHJcbiAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgICBjdHgubGluZUNhcCA9IFwicm91bmRcIjtcclxuICAgICAgICAgICAgdmFyIHQgPSAxO1xyXG4gICAgICAgICAgICB2YXIgdmVydGljZXMgPSBbXTtcclxuICAgICAgICAgICAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24ob2JqKXtcclxuICAgICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2gob2JqKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gdmVydGljZXMucHVzaCh7eDowLHk6MH0pO1xyXG4gICAgICAgICAgICAvLyB2ZXJ0aWNlcy5wdXNoKHt4OjMwMCx5OjEwMH0pO1xyXG4gICAgICAgICAgICAvLyB2ZXJ0aWNlcy5wdXNoKHt4OjgwLHk6MjAwfSk7XHJcbiAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxO1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRzID0gY2FsY1dheXBvaW50cyh2ZXJ0aWNlcyk7XHJcbiAgICAgICAgICAgIGFuaW1hdGUocG9pbnRzKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGNXYXlwb2ludHModmVydGljZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciB3YXlwb2ludHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdmVydGljZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcHQwID0gdmVydGljZXNbaSAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwdDEgPSB2ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZHggPSBwdDEueCAtIHB0MC54O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkeSA9IHB0MS55IC0gcHQwLnk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDA7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHB0MC54ICsgZHggKiBqIC8gMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IHB0MC55ICsgZHkgKiBqIC8gMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXlwb2ludHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiB4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHdheXBvaW50cyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFuaW1hdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCA8IHBvaW50cy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gZHJhdyBhIGxpbmUgc2VnbWVudCBmcm9tIHRoZSBsYXN0IHdheXBvaW50XHJcbiAgICAgICAgICAgICAgICAvLyB0byB0aGUgY3VycmVudCB3YXlwb2ludFxyXG4gICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhwb2ludHNbdCAtIDFdLngsIHBvaW50c1t0IC0gMV0ueSk7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVRvKHBvaW50c1t0XS54LCBwb2ludHNbdF0ueSk7XHJcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBpbmNyZW1lbnQgXCJ0XCIgdG8gZ2V0IHRoZSBuZXh0IHdheXBvaW50XHJcbiAgICAgICAgICAgICAgICB0Kz01O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY3V0SW1nKGNhbiwgYSwgYikge1xyXG4gICAgICAgICAgICAvLyB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzaG93Y2FudmFzXCIpO1xyXG4gICAgICAgICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgICAgIHZhciBpbWFnZURhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKGEueCwgYS55LCBiLngsIGIueSk7XHJcbiAgICAgICAgICAgIHZhciBuZXdDYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgbmV3Q2FuLndpZHRoID0gYi54IC0gYS54O1xyXG4gICAgICAgICAgICBuZXdDYW4uaGVpZ2h0ID0gYi55IC0gYS55O1xyXG4gICAgICAgICAgICB2YXIgbmV3Q3R4ID0gbmV3Q2FuLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHB1dCB0aGUgY2xpcHBlZCBpbWFnZSBvbiB0aGUgbmV3IGNhbnZhcy5cclxuICAgICAgICAgICAgbmV3Q3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3Q2FuO1xyXG4gICAgICAgIH1cclxuICAgIH0sIFxyXG4gICAgbW91bnRlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaGVja1VwaW1nKCk7XHJcbiAgICAgICAgLy8gdm0ubG9hZGNhbnZhcygpO1xyXG4gICAgICAgIC8vIEVYSUYuZ2V0RGF0YShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1nJyksIGZ1bmN0aW9uKCl7IFxyXG4gICAgICAgIC8vICAgICBFWElGLmdldEFsbFRhZ3ModGhpcyk7IFxyXG4gICAgICAgIC8vICAgICBFWElGLmdldFRhZyh0aGlzLCAnT3JpZW50YXRpb24nKTsgXHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gJChcIiN1c2VycGljXCIpLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyAgICAgdm0ucmVhZFVSTCh0aGlzKTtcclxuICAgICAgICAvLyB9KTtcclxuICAgIH1cclxufSlcclxuIl19
