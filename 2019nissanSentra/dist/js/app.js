"use strict";var production="false"===$("#appjs").data("mode"),friendo_url=$("#appjs").data("site"),device=deviceCheck();Vue.config.devtools=!production,Vue.config.debug=!production,Vue.config.silent=!production;var md=new MobileDetect(window.navigator.userAgent),tag=document.createElement("script");function findGetParameter(t){var o=null,n=[];return location.search.substr(1).split("&").forEach(function(e){(n=e.split("="))[0]===t&&(o=decodeURIComponent(n[1]))}),o}function checkCookie(t){var o=null,n=[];return document.cookie.split(";").forEach(function(e){" "==e.charAt(0)&&(e=e.substring(1)),(n=e.split("="))[0]===t&&(o=n[1])}),o}function deviceCheck(){var e={},t=new MobileDetect(window.navigator.userAgent);return t.match(/android/i)?(e.os="android",e.version=t.version("android")):t.match(/(iphone|ipad|ipod);?/i)?(e.os="ios",e.version=t.version("iOS")):(e.os="pc",e.version=t.version("Chrome")),e}$(function(){console.log("v1.0"),console.log(device),$(".nav").menu()}),Vue.mixin({data:function(){return{status:"",start_date:"2100/08/09 12:09:10",error_msg:"",mode:production?"Started":"Testing",loading:!1,popuptop:"",navHeight:"",rewardShake:!0,lineHref:"",token:"",popup:"",popupPage:"",popupTxt:"",reCaptcha:""}},computed:{openCome:function(){return!("Testing"==this.mode||start_date<=0)}},watch:{error_msg:function(e){$("body").toggleClass("_freeze")}},methods:{gaEvant:function(e){dataLayer.push({event:e}),console.log("ga:",e)},server_busy:function(){var e=this;e.error_msg="系統忙碌中，請稍後在試!",e.loading=!1,e.error_cou=6},setCookie:function(e,t,o){var n=new Date;n.setTime(n.getTime()+1e3*o);var a="expires="+n.toUTCString();document.cookie=e+"="+t+";"+a+";"},logger:function(e,t,o){if(production){_LTracker.push({level:["ERROR","DEBUG","WARNING","INFO","ALL"][e],content:JSON.stringify(t),path:window.location.href,tag:o||null,device:device,timestamp:Date.now()})}},errorDone:function(){this.error_msg=""},checkOnline:function(){navigator.onLine||alert("Internet 連線已斷開，請確認您的網路狀態。")},state_check:function(){var o=this;return $.ajax({method:"GET",url:friendo_url+"GetProjectInfo",success:function(e){var t=e.Data;o.start_date=t.StartDateTime,o.mode=t.Status}})},scrollTo:function(e){var t=this;t.room=null,t.allPopupClose(),$("html,body").animate({scrollTop:$(e).offset().top-t.navHeight},500)},popupOpen:function(){var e=this;e.popuptop&&0!==e.popuptop||(e.popuptop=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)),$("body").addClass("_freeze")},popupClose:function(){var e=this;$("body").removeClass("_freeze"),$("html, body").scrollTop(e.popuptop),e.popup="",e.popupPage="",e.popupTxt=""},afterEnter:function(){this.popupOpen()},getToken:function(){var t=this;return $.ajax({url:friendo_url+"/Login/Get?projectId=1",headers:{WebToken:"EYtbcRAm5qSpjpnFJujGAQ=="},method:"GET",dataType:"json"}).done(function(e){console.log(e),t.token=e.Data})},postFace:function(){var e=this,t={Image:e.facebase64.replace(/^data:.*?;base64,/,""),Captcha:e.reCaptcha};return $.ajax({url:friendo_url+"/Sentra201904/FaceDetect",headers:{Authorization:e.token},data:t,method:"POST",dataType:"json"}).done(function(e){console.log(e),console.log(e.Data.Face.FaceLandmarks)})},getResult:function(){var e={ID:this.faceId};return $.ajax({url:friendo_url+"/sentra201904/GetDetectResult",headers:{Authorization:this.token},data:e,method:"POST",dataType:"json"}).done(function(e){console.log(e)})},fbImgpost:function(){var e={ID:this.faceId,Image:this.fbImg.replace(/^data:.*?;base64,/,"")};return $.ajax({url:friendo_url+"/sentra201904/SaveShare",headers:{Authorization:this.token},data:e,method:"POST",dataType:"json"}).done(function(e){console.log(e)})},perInfopost:function(){var e=this,t={ID:e.faceId,Name:e.perinfo.name,Phone:e.perinfo.mobile,Address:e.perinfo.address};return $.ajax({url:friendo_url+"/sentra201904/SaveLottery",headers:{Authorization:e.token},data:t,method:"POST",dataType:"json"}).done(function(e){console.log(e)})},sendImg:function(){var t=this;if(!t.picAgree)return t.popup="open",t.popupPage="alert",void(t.popupTxt="agree");t.getToken().then(function(){t.postFace().then(function(e){t.faceId=e.Data.ID,t.faceEye=e.Data.Eye,t.faceLip=e.Data.Lip,t.faceNose=e.Data.Nose,t.faceScore=e.Data.Score,t.faceData=e.Data.Face,t.stepPage="step2",t.loadcanvas(),t.scanstep(),t.cutImg(),t.cutImg2()})})},sendId:function(){var t=this;t.getToken().then(function(){t.getResult().then(function(e){t.faceEye=e.Data.Eye,t.faceLip=e.Data.Lip,t.faceNose=e.Data.Nose,t.faceScore=parseFloat(Math.round(100*e.Data.Score)/100).toFixed(1),t.faceUrl=e.Data.FaceUrl,t.setfbBg(),t.setans(),$(".starbg img").css("transform","translateX("+(20*t.faceScore-100)+"%)")})})},sendFbshare:function(){var t=this;t.getToken().then(function(){t.fbImgpost().then(function(e){t.fbshare(),t.stepPage="perform",t.popupClose()})})},sendperInfo:function(){var t=this;""!=t.perinfo.name?""!=t.perinfo.mobile&&t.perinfo.mobile.match(/^09[0-9]{8}$/)?""!=t.perinfo.address?t.perinfo.agree?t.getToken().then(function(){t.perInfopost().then(function(e){e.Data&&(t.popup="open",t.popupPage="alert",t.popupTxt="success",setTimeout(function(){window.open("product.html","_self")},1e3))})}):alert("請勾選同意"):alert("請輸入地址"):alert("手機格式錯誤"):alert("請輸入姓名")},sharebox:function(){this.fbcanvas(),this.popup="open",this.popupPage="alert",this.popupTxt="share"},eventnoteOpen:function(){this.popup="open",this.popupPage="note"},grecaptcha:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){var t=this;grecaptcha.ready(function(){grecaptcha.execute("6LcRbZ4UAAAAAPogVKoUTG5Zc16lL5tWP3Jjl8Tj",{action:e}).then(function(e){t.reCaptcha=e})})})},components:{comingsoon:comingsoon},mounted:function(){$(".nav-lock").click(function(){$("body").removeClass("_freeze")})}}),Vue.component("comingsoon",{template:"#comingsoon",props:["StartDate","mode"],data:function(){return{comingsoon:!1,date:{total:0,days:0,hours:0,minutes:0,seconds:0}}},mounted:function(){var r=function e(t,o){return(t=""+t).length>=o?t:e("0"+t,o)},i=this,c=setInterval(function(){var e=Date.parse(new Date(i.StartDate))-Date.parse(new Date),t=Math.floor(e/1e3%60),o=Math.floor(e/1e3/60%60),n=Math.floor(e/36e5%24),a=Math.floor(e/864e5);i.date={total:e,days:r(a,2),hours:r(n,2),minutes:r(o,2),seconds:r(t,2)},i.date.total<=0||"Testing"==i.mode?(clearInterval(c),i.comingsoon=!1):i.comingsoon=!0},1e3)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwiJCIsImRhdGEiLCJkZXZpY2UiLCJkZXZpY2VDaGVjayIsIlZ1ZSIsImNvbmZpZyIsImRldnRvb2xzIiwiZGVidWciLCJtZCIsIk1vYmlsZURldGVjdCIsIndpbmRvdyIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInRhZyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImZpbmRHZXRQYXJhbWV0ZXIiLCJwYXJhbWV0ZXJOYW1lIiwicmVzdWx0IiwidG1wIiwibG9jYXRpb24iLCJzZWFyY2giLCJpdGVtIiwic3BsaXQiLCJmb3JFYWNoIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiY29va2llIiwiY2hhckF0Iiwic3Vic3RyaW5nIiwidmVyc2lvbiIsInN0YXJ0X2RhdGUiLCJtYXRjaCIsIm9zIiwiY29uc29sZSIsImxvZyIsIm1vZGUiLCJsb2FkaW5nIiwicG9wdXB0b3AiLCJuYXZIZWlnaHQiLCJyZXdhcmRTaGFrZSIsImxpbmVIcmVmIiwidG9rZW4iLCJwb3B1cCIsInBvcHVwUGFnZSIsInBvcHVwVHh0IiwicmVDYXB0Y2hhIiwiY29tcHV0ZWQiLCJvcGVuQ29tZSIsImVycm9yX21zZyIsInRoaXMiLCJnYUV2YW50IiwiZGF0YUxheWVyIiwidmFsIiwiZ3RtRGF0YSIsIm1ldGhvZHMiLCJ2bSIsInB1c2giLCJldmVudCIsImVycm9yX2NvdSIsInNldENvb2tpZSIsImQiLCJzZXRUaW1lIiwiZ2V0VGltZSIsImV4cGlyZXMiLCJsb2dnZXIiLCJjbmFtZSIsImxldmVsIiwiY29udGVudCIsInRpbWUiLCJsZXZlbF9pbmZvIiwidG9VVENTdHJpbmciLCJfTFRyYWNrZXIiLCJjdmFsdWUiLCJKU09OIiwic3RyaW5naWZ5IiwicGF0aCIsImhyZWYiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXJyb3JEb25lIiwic3RhdGVfY2hlY2siLCJvbkxpbmUiLCJhbGVydCIsImFqYXgiLCJ1cmwiLCJmcmllbmRvX3VybCIsInN1Y2Nlc3MiLCJyZXMiLCJEYXRhIiwiU3RhcnREYXRlVGltZSIsIlN0YXR1cyIsInNjcm9sbFRvIiwiZSIsInBvcHVwT3BlbiIsImFsbFBvcHVwQ2xvc2UiLCJNYXRoIiwicGFnZVlPZmZzZXQiLCJwb3B1cENsb3NlIiwicmVtb3ZlQ2xhc3MiLCJtYXgiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJib2R5IiwiYWRkQ2xhc3MiLCJhZnRlckVudGVyIiwiZ2V0VG9rZW4iLCJtZXRob2QiLCJkb25lIiwicG9zdEZhY2UiLCJwb3N0X2RhdGEiLCJmYWNlYmFzZTY0IiwiaGVhZGVycyIsIkltYWdlIiwiQ2FwdGNoYSIsImRhdGFUeXBlIiwiZ2V0UmVzdWx0IiwiZmFjZUlkIiwiSUQiLCJmYkltZ3Bvc3QiLCJmYkltZyIsInJlcGxhY2UiLCJwZXJJbmZvcG9zdCIsIm5hbWUiLCJwZXJpbmZvIiwibW9iaWxlIiwiQWRkcmVzcyIsInNlbmRJbWciLCJwaWNBZ3JlZSIsImZhY2VTY29yZSIsImZhY2VEYXRhIiwiRmFjZSIsInN0ZXBQYWdlIiwibG9hZGNhbnZhcyIsIkV5ZSIsInNjYW5zdGVwIiwiTGlwIiwiY3V0SW1nIiwiTm9zZSIsImN1dEltZzIiLCJTY29yZSIsImZhY2VVcmwiLCJ0aGVuIiwic2V0YW5zIiwiZmFjZUxpcCIsImNzcyIsImZhY2VOb3NlIiwicGFyc2VGbG9hdCIsInJvdW5kIiwidG9GaXhlZCIsIkZhY2VVcmwiLCJzZW5kRmJzaGFyZSIsInNldGZiQmciLCJzZW5kcGVySW5mbyIsImZic2hhcmUiLCJwaG9uZV9ydWxlIiwiYWRkcmVzcyIsInNldFRpbWVvdXQiLCJvcGVuIiwic2hhcmVib3giLCJldmVudG5vdGVPcGVuIiwiZmJjYW52YXMiLCJncmVjYXB0Y2hhIiwiX3giLCJfZ3JlY2FwdGNoYSIsImFwcGx5IiwiYXJndW1lbnRzIiwidG9TdHJpbmciLCJwYWdlIiwicmVhZHkiLCJleGVjdXRlIiwiYWN0aW9uIiwiY29tcG9uZW50cyIsImNvbWluZ3Nvb24iLCJtb3VudGVkIiwiY2xpY2siLCJjb21wb25lbnQiLCJ0ZW1wbGF0ZSIsInByb3BzIiwiZGF0ZSIsInRvdGFsIiwiZGF5cyIsInBhZExlZnQiLCJzdHIiLCJsZW4iLCJsZW5ndGgiLCJ0aW1laW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInQiLCJwYXJzZSIsIlN0YXJ0RGF0ZSIsInNlY29uZHMiLCJmbG9vciIsIm1pbnV0ZXMiLCJob3VycyIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJhQUFBLElBQ0lBLFdBQTBDLFVBQTdCQyxFQUFFLFVBQVVDLEtBQUssUUFBOUJGLFlBQWFDLEVBQUUsVUFBVUMsS0FBSyxRQUc1QkMsT0FBU0MsY0FFZkMsSUFBSUMsT0FBT0MsVUFBWVAsV0FBdkJLLElBQUlDLE9BQU9DLE9BQVhQLFdBQ0FLLElBQUlDLE9BQU9FLFFBQVNSLFdBR3BCLElBQUlTLEdBQUssSUFBSUMsYUFBYUMsT0FBT0MsVUFBVUMsV0FFdkNDLElBQU1DLFNBQVNDLGNBQWMsVUFTakMsU0FBU0MsaUJBQWlCQyxHQUN0QixJQUFJQyxFQUFTLEtBQ1RDLEVBQU0sR0FhVixPQVpBQyxTQUFTQyxPQUlERixPQUFNRyxHQUNOQyxNQUFJSixLQUxaSyxRQUFBLFNBQUFGLElBUU9KLEVBQVBJLEVBQUFDLE1BQUEsTUFDSCxLQUFBTixJQUhlQyxFQUFTTyxtQkFBbUJOLEVBQUksT0FNeENELEVBR0pRLFNBQUFBLFlBQUFULEdBRVEsSUFBQUMsRUFBU1MsS0FDTEwsRUFBQUEsR0FZUnBCLE9BWEtZLFNBQUFZLE9BQ0RQLE1BQU1HLEtBQ05FLFFBQUksU0FBV1AsR0FOdkIsS0FBQUssRUFBQUssT0FBQSxLQVNPVCxFQUFQSSxFQUFBTSxVQUFBLEtBRUt6QixFQUFBQSxFQUFjb0IsTUFBQSxNQUNuQixLQUFBTixJQUNTQyxFQUFJVCxFQUFKLE1BRUxQLEVBRUgsU0FIREMsY0FJSUQsSUFBQUEsRUFBQSxHQUNBQSxFQUFBQSxJQUFPMkIsYUFBYUEsT0FBUWxCLFVBQTVCQyxXQVdJa0IsT0FiRHRCLEVBR0F1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SUFDbkNDLEVBQUk5RyxLQUFLK0csTUFBVS9HLEVBQUFBLEtBQXNCQSxJQUN6Q2lILEVBQUFBLEtBQVUvRixNQUFLZ0csRUFBQUEsT0FDbkJ6SSxFQUFBNEgsS0FBSWMsQ0FDQUMsTUFBUWxHLEVBQ1JxRixLQUFPckYsRUFBS2dHLEVBQU1KLEdBQ25CVCxNQUFPRyxFQUFBWSxFQUFBLEdBQ05ELFFBRE1YLEVBQUFXLEVBQUEsR0FFTkYsUUFBUVQsRUFBUUQsRUFGVixJQUlOOUgsRUFBQTRILEtBQUFDLE9BQVdFLEdBSkwsV0FJYVcsRUFBQUEsTUFDbkJFLGNBQVdiLEdBTGYvSCxFQUFBc0gsWUFBQSxHQVFJc0IsRUFBQUEsWUFBY1QsR0FFakIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3RcclxuICAgIHByb2R1Y3Rpb24gPSAkKFwiI2FwcGpzXCIpLmRhdGEoXCJtb2RlXCIpID09PSBcImZhbHNlXCIsXHJcbiAgICBmcmllbmRvX3VybCA9ICQoXCIjYXBwanNcIikuZGF0YShcInNpdGVcIik7XHJcblxyXG5jb25zdCBkZXZpY2UgPSBkZXZpY2VDaGVjaygpO1xyXG5cclxuVnVlLmNvbmZpZy5kZXZ0b29scyA9ICFwcm9kdWN0aW9uO1xyXG5WdWUuY29uZmlnLmRlYnVnID0gIXByb2R1Y3Rpb247XHJcblZ1ZS5jb25maWcuc2lsZW50ID0gIXByb2R1Y3Rpb247XHJcblxyXG52YXIgbWQgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxuXHJcbnZhciB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc29sZS5sb2coXCJ2MS4wXCIpO1xyXG4gICAgY29uc29sZS5sb2coZGV2aWNlKTtcclxuICAgICQoXCIubmF2XCIpLm1lbnUoKTtcclxufSk7XHJcblxyXG5cclxuZnVuY3Rpb24gZmluZEdldFBhcmFtZXRlcihwYXJhbWV0ZXJOYW1lKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gbnVsbCxcclxuICAgICAgICB0bXAgPSBbXTtcclxuICAgIGxvY2F0aW9uLnNlYXJjaFxyXG4gICAgICAgIC5zdWJzdHIoMSlcclxuICAgICAgICAuc3BsaXQoXCImXCIpXHJcbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgdG1wID0gaXRlbS5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICAgIGlmICh0bXBbMF0gPT09IHBhcmFtZXRlck5hbWUpXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBkZWNvZGVVUklDb21wb25lbnQodG1wWzFdKTtcclxuICAgICAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrQ29va2llKHBhcmFtZXRlck5hbWUpIHtcclxuICAgIHZhciByZXN1bHQgPSBudWxsLFxyXG4gICAgICAgIHRtcCA9IFtdO1xyXG4gICAgdmFyIGNvb2tpZSA9IGRvY3VtZW50LmNvb2tpZTtcclxuICAgIGNvb2tpZS5zcGxpdChcIjtcIilcclxuICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5jaGFyQXQoMCkgPT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtLnN1YnN0cmluZygxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0bXAgPSBpdGVtLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICAgICAgaWYgKHRtcFswXSA9PT0gcGFyYW1ldGVyTmFtZSlcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRtcFsxXTtcclxuICAgICAgICB9KVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBkZXZpY2VDaGVjaygpIHtcclxuICAgIHZhciBkZXZpY2UgPSB7fTtcclxuICAgIHZhciBtZCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgaWYgKG1kLm1hdGNoKC9hbmRyb2lkL2kpKSB7XHJcbiAgICAgICAgZGV2aWNlLm9zID0gXCJhbmRyb2lkXCI7XHJcbiAgICAgICAgZGV2aWNlLnZlcnNpb24gPSBtZC52ZXJzaW9uKFwiYW5kcm9pZFwiKTtcclxuICAgIH0gZWxzZSBpZiAobWQubWF0Y2goLyhpcGhvbmV8aXBhZHxpcG9kKTs/L2kpKSB7XHJcbiAgICAgICAgZGV2aWNlLm9zID0gXCJpb3NcIjtcclxuICAgICAgICBkZXZpY2UudmVyc2lvbiA9IG1kLnZlcnNpb24oXCJpT1NcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRldmljZS5vcyA9IFwicGNcIjtcclxuICAgICAgICBkZXZpY2UudmVyc2lvbiA9IG1kLnZlcnNpb24oXCJDaHJvbWVcIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGV2aWNlO1xyXG59XHJcblZ1ZS5taXhpbih7XHJcbiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3RhdHVzOiBcIlwiLFxyXG4gICAgICAgICAgICBzdGFydF9kYXRlOiBcIjIxMDAvMDgvMDkgMTI6MDk6MTBcIixcclxuICAgICAgICAgICAgZXJyb3JfbXNnOiBcIlwiLFxyXG4gICAgICAgICAgICBtb2RlOiBwcm9kdWN0aW9uID8gXCJTdGFydGVkXCIgOiBcIlRlc3RpbmdcIixcclxuICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgIHBvcHVwdG9wOiBcIlwiLFxyXG4gICAgICAgICAgICBuYXZIZWlnaHQ6IFwiXCIsXHJcbiAgICAgICAgICAgIHJld2FyZFNoYWtlOiB0cnVlLFxyXG4gICAgICAgICAgICBsaW5lSHJlZjogJycsXHJcbiAgICAgICAgICAgIHRva2VuOiBcIlwiLFxyXG4gICAgICAgICAgICBwb3B1cDogXCJcIixcclxuICAgICAgICAgICAgcG9wdXBQYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICBwb3B1cFR4dDogXCJcIixcclxuICAgICAgICAgICAgcmVDYXB0Y2hhOiBcIlwiXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNvbXB1dGVkOiB7XHJcbiAgICAgICAgb3BlbkNvbWU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEodGhpcy5tb2RlID09IFwiVGVzdGluZ1wiIHx8IHN0YXJ0X2RhdGUgPD0gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHdhdGNoOiB7XHJcbiAgICAgICAgZXJyb3JfbXNnOiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS50b2dnbGVDbGFzcygnX2ZyZWV6ZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgICAgZ2FFdmFudDogZnVuY3Rpb24gKGd0bURhdGEpIHtcclxuICAgICAgICAgICAgZGF0YUxheWVyLnB1c2goeydldmVudCc6IGd0bURhdGF9KTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJnYTpcIiwgZ3RtRGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXJ2ZXJfYnVzeTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2bS5lcnJvcl9tc2cgPSBcIuezu+e1seW/meeijOS4re+8jOiri+eojeW+jOWcqOippiFcIjtcclxuICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2bS5lcnJvcl9jb3UgPSA2O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0Q29va2llOiBmdW5jdGlvbiAoY25hbWUsIGN2YWx1ZSwgdGltZSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgIGQuc2V0VGltZShkLmdldFRpbWUoKSArICh0aW1lICogMTAwMCkpO1xyXG4gICAgICAgICAgICB2YXIgZXhwaXJlcyA9IFwiZXhwaXJlcz1cIiArIGQudG9VVENTdHJpbmcoKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gY25hbWUgKyBcIj1cIiArIGN2YWx1ZSArIFwiO1wiICsgZXhwaXJlcyArIFwiO1wiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG9nZ2VyOiBmdW5jdGlvbiAobGV2ZWwsIGNvbnRlbnQsIHRhZykge1xyXG4gICAgICAgICAgICBpZiAocHJvZHVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gbGV2ZWwgOiBbJ0VSUk9SJyA9PiAwLCBERUJVRycgPT4gMSwgJ1dBUk5JTkcnID0+IDIsICdJTkZPJyA9PiAzLCAnQUxMJyA9PiA0XVxyXG4gICAgICAgICAgICAgICAgdmFyIGxldmVsX2luZm8gPSBbJ0VSUk9SJywgJ0RFQlVHJywgJ1dBUk5JTkcnLCAnSU5GTycsICdBTEwnXTtcclxuICAgICAgICAgICAgICAgIF9MVHJhY2tlci5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAnbGV2ZWwnOiBsZXZlbF9pbmZvW2xldmVsXSxcclxuICAgICAgICAgICAgICAgICAgICAnY29udGVudCc6IEpTT04uc3RyaW5naWZ5KGNvbnRlbnQpLFxyXG4gICAgICAgICAgICAgICAgICAgICdwYXRoJzogd2luZG93LmxvY2F0aW9uLmhyZWYsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RhZyc6IHRhZyB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICdkZXZpY2UnOiBkZXZpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RpbWVzdGFtcCc6IERhdGUubm93KClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlcnJvckRvbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvcl9tc2cgPSBcIlwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2hlY2tPbmxpbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFuYXZpZ2F0b3Iub25MaW5lKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIkludGVybmV0IOmAo+e3muW3suaWt+mWi++8jOiri+eiuuiqjeaCqOeahOe2sui3r+eLgOaFi+OAglwiKTtcclxuICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RhdGVfY2hlY2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfUdldFByb2plY3RJbmZvYCxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzLkRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uc3RhcnRfZGF0ZSA9IGRhdGEuU3RhcnREYXRlVGltZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5tb2RlID0gZGF0YS5TdGF0dXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzY3JvbGxUbzogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucm9vbSA9IG51bGw7XHJcbiAgICAgICAgICAgIHZtLmFsbFBvcHVwQ2xvc2UoKTtcclxuICAgICAgICAgICAgJChcImh0bWwsYm9keVwiKS5hbmltYXRlKHtcclxuICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJChlKS5vZmZzZXQoKS50b3AgLSB2bS5uYXZIZWlnaHRcclxuICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBvcHVwT3BlbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXZtLnBvcHVwdG9wIHx8IHZtLnBvcHVwdG9wID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5wb3B1cHRvcCA9IE1hdGgubWF4KHdpbmRvdy5wYWdlWU9mZnNldCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnX2ZyZWV6ZScpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9wdXBDbG9zZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ19mcmVlemUnKTtcclxuICAgICAgICAgICAgJCgnaHRtbCwgYm9keScpLnNjcm9sbFRvcCh2bS5wb3B1cHRvcCk7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwID0gXCJcIjtcclxuICAgICAgICAgICAgdm0ucG9wdXBQYWdlID1cIlwiO1xyXG4gICAgICAgICAgICB2bS5wb3B1cFR4dCA9IFwiXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZnRlckVudGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwT3BlbigpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0VG9rZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogXCJodHRwczovL2NhcnJlZm91cjIwMTljbnkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL2F1dGgvbG9naW4/cHJvamVjdElkPTYxXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfS9Mb2dpbi9HZXQ/cHJvamVjdElkPTFgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiV2ViVG9rZW5cIjogXCJFWXRiY1JBbTVxU3BqcG5GSnVqR0FRPT1cIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXHJcbiAgICAgICAgICAgICAgICB2bS50b2tlbiA9IHJlcy5EYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9zdEZhY2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJJbWFnZVwiIDogdm0uZmFjZWJhc2U2NC5yZXBsYWNlKC9eZGF0YTouKj87YmFzZTY0LC8sIFwiXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJDYXB0Y2hhXCIgOiB2bS5yZUNhcHRjaGFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9L1NlbnRyYTIwMTkwNC9GYWNlRGV0ZWN0YCxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogdm0udG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLkRhdGEuRmFjZS5GYWNlTGFuZG1hcmtzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRSZXN1bHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJJRFwiIDogdm0uZmFjZUlkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IFwiaHR0cHM6Ly9jYXJyZWZvdXIyMDE5Y255LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9hdXRoL2xvZ2luP3Byb2plY3RJZD02MVwiLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH0vc2VudHJhMjAxOTA0L0dldERldGVjdFJlc3VsdGAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IHZtLnRva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCJcclxuICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZiSW1ncG9zdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcIklEXCIgOiB2bS5mYWNlSWQsXHJcbiAgICAgICAgICAgICAgICBcIkltYWdlXCIgOiB2bS5mYkltZy5yZXBsYWNlKC9eZGF0YTouKj87YmFzZTY0LC8sIFwiXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IFwiaHR0cHM6Ly9jYXJyZWZvdXIyMDE5Y255LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9hdXRoL2xvZ2luP3Byb2plY3RJZD02MVwiLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH0vc2VudHJhMjAxOTA0L1NhdmVTaGFyZWAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IHZtLnRva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCJcclxuICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBlckluZm9wb3N0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwiSURcIiA6IHZtLmZhY2VJZCxcclxuICAgICAgICAgICAgICAgIFwiTmFtZVwiIDogdm0ucGVyaW5mby5uYW1lLFxyXG4gICAgICAgICAgICAgICAgXCJQaG9uZVwiOiB2bS5wZXJpbmZvLm1vYmlsZSxcclxuICAgICAgICAgICAgICAgIFwiQWRkcmVzc1wiOiB2bS5wZXJpbmZvLmFkZHJlc3NcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogXCJodHRwczovL2NhcnJlZm91cjIwMTljbnkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL2F1dGgvbG9naW4/cHJvamVjdElkPTYxXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfS9zZW50cmEyMDE5MDQvU2F2ZUxvdHRlcnlgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiB2bS50b2tlbixcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBwb3N0X2RhdGEsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZW5kSW1nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgaWYoIXZtLnBpY0FncmVlKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5wb3B1cCA9IFwib3BlblwiO1xyXG4gICAgICAgICAgICAgICAgdm0ucG9wdXBQYWdlID0gXCJhbGVydFwiO1xyXG4gICAgICAgICAgICAgICAgdm0ucG9wdXBUeHQgPSBcImFncmVlXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2bS5nZXRUb2tlbigpLnRoZW4oZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHZtLnBvc3RGYWNlKCkudGhlbihmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZhY2VJZCA9IHJlcy5EYXRhLklEO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZhY2VFeWUgPSByZXMuRGF0YS5FeWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmFjZUxpcCA9IHJlcy5EYXRhLkxpcDtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYWNlTm9zZSA9IHJlcy5EYXRhLk5vc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmFjZVNjb3JlID0gcmVzLkRhdGEuU2NvcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmFjZURhdGEgPSByZXMuRGF0YS5GYWNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnN0ZXBQYWdlID0gXCJzdGVwMlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRjYW52YXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5zY2Fuc3RlcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmN1dEltZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmN1dEltZzIoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbmRJZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLmdldFRva2VuKCkudGhlbihmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdm0uZ2V0UmVzdWx0KCkudGhlbihmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZhY2VFeWUgPSByZXMuRGF0YS5FeWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmFjZUxpcCA9IHJlcy5EYXRhLkxpcDtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYWNlTm9zZSA9IHJlcy5EYXRhLk5vc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmFjZVNjb3JlID0gcGFyc2VGbG9hdChNYXRoLnJvdW5kKHJlcy5EYXRhLlNjb3JlKjEwMCkvMTAwKS50b0ZpeGVkKDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZhY2VVcmwgPSByZXMuRGF0YS5GYWNlVXJsO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnNldGZiQmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5zZXRhbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiLnN0YXJiZyBpbWdcIikuY3NzKFwidHJhbnNmb3JtXCIsXCJ0cmFuc2xhdGVYKFwiKyh2bS5mYWNlU2NvcmUqMjAtMTAwKStcIiUpXCIpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbmRGYnNoYXJlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICB2bS5mYkltZ3Bvc3QoKS50aGVuKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZmJzaGFyZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnN0ZXBQYWdlID0gXCJwZXJmb3JtXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucG9wdXBDbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbmRwZXJJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBob25lX3J1bGUgPSAvXjA5WzAtOV17OH0kLztcclxuICAgICAgICAgICAgaWYodm0ucGVyaW5mby5uYW1lID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL6Ly45YWl5aeT5ZCNXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodm0ucGVyaW5mby5tb2JpbGUgPT0gXCJcIiB8fCAhdm0ucGVyaW5mby5tb2JpbGUubWF0Y2gocGhvbmVfcnVsZSkpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi5omL5qmf5qC85byP6Yyv6KqkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodm0ucGVyaW5mby5hZGRyZXNzID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL6Ly45YWl5Zyw5Z2AXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoIXZtLnBlcmluZm8uYWdyZWUpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL5Yu+6YG45ZCM5oSPXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICB2bS5wZXJJbmZvcG9zdCgpLnRoZW4oZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5wb3B1cCA9IFwib3BlblwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5wb3B1cFBhZ2UgPSBcImFsZXJ0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnBvcHVwVHh0ID0gXCJzdWNjZXNzXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKFwicHJvZHVjdC5odG1sXCIsXCJfc2VsZlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwxMDAwKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaGFyZWJveDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLmZiY2FudmFzKCk7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwID0gXCJvcGVuXCI7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwUGFnZSA9IFwiYWxlcnRcIjtcclxuICAgICAgICAgICAgdm0ucG9wdXBUeHQgPSBcInNoYXJlXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBldmVudG5vdGVPcGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucG9wdXAgPSBcIm9wZW5cIjtcclxuICAgICAgICAgICAgdm0ucG9wdXBQYWdlID0gXCJub3RlXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyZWNhcHRjaGE6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEuZXhlY3V0ZSgnNkxjUmJaNFVBQUFBQVBvZ1ZLb1VURzVaYzE2bEw1dFdQM0pqbDhUaicsIHthY3Rpb246IHBhZ2V9KS50aGVuKGZ1bmN0aW9uKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucmVDYXB0Y2hhID0gdG9rZW47XHJcbiAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNvbXBvbmVudHM6IHtcclxuICAgICAgICBjb21pbmdzb29uOiBjb21pbmdzb29uXHJcbiAgICB9LFxyXG4gICAgbW91bnRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgLy8gZml4LWJvZHktc3BhY2VcclxuICAgICAgICAvLyB2YXIgbmF2SGVpZ2h0ID0gJCgnLndpbmRvdy10b3AnKS5oZWlnaHQoKTtcclxuICAgICAgICAvLyB2bS5uYXZIZWlnaHQgPSBuYXZIZWlnaHQgLSAzMDtcclxuICAgICAgICAvLyAkKCdib2R5JykuY3NzKCdtYXJnaW4tdG9wJywgdm0ubmF2SGVpZ2h0KTtcclxuICAgICAgICAkKFwiLm5hdi1sb2NrXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICQoXCJib2R5XCIpLnJlbW92ZUNsYXNzKFwiX2ZyZWV6ZVwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIGFsZXJ0KCdhJylcclxuICAgIH1cclxufSlcclxuXHJcblxyXG5WdWUuY29tcG9uZW50KCdjb21pbmdzb29uJywge1xyXG4gICAgdGVtcGxhdGU6IFwiI2NvbWluZ3Nvb25cIixcclxuICAgIHByb3BzOiBbJ1N0YXJ0RGF0ZScsICdtb2RlJ10sXHJcbiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY29taW5nc29vbjogZmFsc2UsXHJcbiAgICAgICAgICAgIGRhdGU6IHtcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICAgICAgZGF5czogMCxcclxuICAgICAgICAgICAgICAgIGhvdXJzOiAwLFxyXG4gICAgICAgICAgICAgICAgbWludXRlczogMCxcclxuICAgICAgICAgICAgICAgIHNlY29uZHM6IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICBcclxuICAgIH0sXHJcbiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhZExlZnQgPSBmdW5jdGlvbiAoc3RyLCBsZW4pIHtcclxuICAgICAgICAgICAgc3RyID0gJycgKyBzdHI7XHJcbiAgICAgICAgICAgIGlmIChzdHIubGVuZ3RoID49IGxlbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYWRMZWZ0KFwiMFwiICsgc3RyLCBsZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIC8vIHZtLnN0YXRlX2NoZWNrKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgLy8gICAgIHZhciBkYXRhID0gcmVzLkRhdGE7XHJcbiAgICAgICAgLy8gICAgIHZtLnN0YXJ0X2RhdGUgPSBkYXRhLlN0YXJ0RGF0ZVRpbWU7XHJcbiAgICAgICAgdmFyIHRpbWVpbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBEYXRlLnBhcnNlKG5ldyBEYXRlKHZtLlN0YXJ0RGF0ZSkpIC0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKCh0IC8gMTAwMCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcigodCAvIDEwMDAgLyA2MCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoKHQgLyAoMTAwMCAqIDYwICogNjApKSAlIDI0KTtcclxuICAgICAgICAgICAgdmFyIGRheXMgPSBNYXRoLmZsb29yKHQgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xyXG4gICAgICAgICAgICB2bS5kYXRlID0ge1xyXG4gICAgICAgICAgICAgICAgJ3RvdGFsJzogdCxcclxuICAgICAgICAgICAgICAgICdkYXlzJzogcGFkTGVmdChkYXlzLCAyKSxcclxuICAgICAgICAgICAgICAgICdob3Vycyc6IHBhZExlZnQoaG91cnMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ21pbnV0ZXMnOiBwYWRMZWZ0KG1pbnV0ZXMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ3NlY29uZHMnOiBwYWRMZWZ0KHNlY29uZHMsIDIpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmICh2bS5kYXRlLnRvdGFsIDw9IDAgfHwgdm0ubW9kZSA9PSBcIlRlc3RpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1laW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgdm0uY29taW5nc29vbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdm0uY29taW5nc29vbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAvLyB9KTtcclxuICAgIH0sXHJcbn0pXHJcbiJdfQ==
