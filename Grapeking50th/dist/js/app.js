"use strict";var production="false"===$("#appjs").data("mode"),friendo_url=$("#appjs").data("site"),device=deviceCheck();Vue.config.devtools=!production,Vue.config.debug=!production,Vue.config.silent=!production;var md=new MobileDetect(window.navigator.userAgent),tag=document.createElement("script");function findGetParameter(t){var o=null,a=[];return location.search.substr(1).split("&").forEach(function(e){(a=e.split("="))[0]===t&&(o=decodeURIComponent(a[1]))}),o}function checkCookie(t){var o=null,a=[];return document.cookie.split(";").forEach(function(e){" "==e.charAt(0)&&(e=e.substring(1)),(a=e.split("="))[0]===t&&(o=a[1])}),o}function deviceCheck(){var e={},t=new MobileDetect(window.navigator.userAgent);return t.match(/android/i)?(e.os="android",e.version=t.version("android")):t.match(/(iphone|ipad|ipod);?/i)?(e.os="ios",e.version=t.version("iOS")):(e.os="pc",e.version=t.version("Chrome")),e}$(function(){console.log("v1.0"),console.log(device),$(".nav").menu()}),Vue.mixin({data:function(){return{status:"",error_msg:"",loading:!1,popuptop:"",navHeight:"",rewardShake:!0,lineHref:"",gToken:"",Logo:"",fbData:{mb_id:"",token:"",fb_id:"",fbName:"",fbPic:"",fbPhone:""},user:{phone:""},play:{ticket:"",code:"",score:0},popup:!1,popPage:"",gameStep:"",awardList:"",reCaptcha:""}},computed:{openCome:function(){return!("Testing"==this.mode||start_date<=0)}},watch:{error_msg:function(e){$("body").toggleClass("_freeze")}},methods:{gaEvant:function(e){dataLayer.push({event:e}),console.log("ga:",e)},server_busy:function(){var e=this;e.error_msg="系統忙碌中，請稍後在試!",e.loading=!1,e.error_cou=6},setCookie:function(e,t,o){var a=new Date;a.setTime(a.getTime()+1e3*o);var n="expires="+a.toUTCString();document.cookie=e+"="+t+";"+n+";"},logger:function(e,t,o){if(production){_LTracker.push({level:["ERROR","DEBUG","WARNING","INFO","ALL"][e],content:JSON.stringify(t),path:window.location.href,tag:o||null,device:device,timestamp:Date.now()})}},errorDone:function(){this.error_msg=""},checkOnline:function(){navigator.onLine||alert("Internet 連線已斷開，請確認您的網路狀態。")},getToken:function(){var t=this;return $.ajax({url:"".concat(friendo_url,"auth/login?projectId=67"),headers:{WebToken:"u+Fw6wqP5Tgn+txlgClW+g=="},method:"GET",dataType:"json",success:function(e){t.gToken=e.token}})},state_check:function(){var t=this,e={mb_id:t.fbData.mb_id};return $.ajax({url:"".concat(friendo_url,"comebest2/getstatus"),headers:{Authorization:"Bearer "+t.gToken},data:e,method:"POST",dataType:"json",success:function(e){3==e.data.game_status?t.mode_status="timeover":1==e.data.game_status?(t.mode_status="comingsoon",t.start_date=e.data.start_date):t.mode_status="started"}})},getStatus:function(){var t=this,e={mb_id:t.fbData.mb_id};return $.ajax({url:"".concat(friendo_url,"comebest2/getstatus"),headers:{Authorization:"Bearer "+t.gToken},data:e,method:"POST",dataType:"json",success:function(e){t.fbData.fbName=e.data.name,t.fbData.fbPic=e.data.pic_url,t.fbData.fbPhone=e.data.phone}})},register:function(){var t=this,e={token:t.fbData.token,fb_id:t.fbData.fb_id};return $.ajax({url:"".concat(friendo_url,"comebest2/register"),headers:{Authorization:"Bearer "+t.gToken},data:e,method:"POST",dataType:"json",success:function(e){console.log("mb_id",e),t.fbData.mb_id=e.data}})},fbshare:function(){var e={mb_id:this.fbData.mb_id};return $.ajax({url:"".concat(friendo_url,"comebest2/fbshare"),headers:{Authorization:"Bearer "+this.gToken},data:e,method:"POST",dataType:"json",success:function(e){}})},savePhone:function(){var e={mb_id:this.fbData.mb_id,phone:this.user.phone};return $.ajax({url:"".concat(friendo_url,"comebest2/savephone"),headers:{Authorization:"Bearer "+this.gToken},data:e,method:"POST",dataType:"json",success:function(e){}})},playTicket:function(){var e={mb_id:this.fbData.mb_id,score:this.total};return $.ajax({url:"".concat(friendo_url,"comebest2/play"),headers:{Authorization:"Bearer "+this.gToken},data:e,method:"POST",dataType:"json",success:function(e){console.log("play",e)}})},record:function(){var e={mb_id:this.fbData.mb_id,ticket:this.play.ticket,score:this.play.score};return $.ajax({url:"".concat(friendo_url,"comebest2/record"),headers:{Authorization:"Bearer "+this.gToken},data:e,method:"POST",dataType:"json",success:function(e){}})},top100:function(){var e={mb_id:this.fbData.mb_id};return $.ajax({url:"".concat(friendo_url,"comebest2/top100"),headers:{Authorization:"Bearer "+this.gToken},data:e,method:"POST",dataType:"json",success:function(e){}})},invoiceSave:function(){var e=this,t={cell:e.mobile,inv_num:e.inv_num.toUpperCase(),random_number:e.inv_random,inv_date:e.inv_date,actToken:"Te8RvO6ZlEjaJJtTetH8Mg==",captcha:e.reCaptcha};return $.ajax({url:"".concat(friendo_url,"invoice/savedata"),headers:{Authorization:"Bearer "+e.gToken},data:t,method:"POST",dataType:"json"}).done(function(e){})},getaward:function(){return $.ajax({url:"".concat(friendo_url,"comebest2/LotteryResult/67"),headers:{Authorization:"Bearer "+this.gToken},method:"GET"}).done(function(e){console.log("getaward",e)})},grecaptcha:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(o){var a=this;return new Promise(function(t,e){grecaptcha.execute("6Ld54LMUAAAAAKnhc5FkZICJ4ioSlF7t5ofMg0Ng",{action:o}).then(function(e){a.reCaptcha=e,t()},function(){alert("Google驗證失敗，請再次嘗試\n如無法排除此問題，建議重新整理此頁面"),e()})})}),getRecipientinfo:function(){var t=this;return $.ajax({url:"".concat(friendo_url,"comebest2/recipientinfo/").concat(t.userid),headers:{Authorization:"Bearer "+t.gToken},method:"GET"}).done(function(e){e.success?(t.mobile=e.data.mobile,t.inv_num=e.data.referenceInfo,t.awarditem=e.data.awardName,t.type=e.data.referenceType):(alert("資料已回填或無法查獲此獎項"),window.location.href="./index.html"),t.ploading=!1})},postRecipientinfo:function(){var e=this,t=new FormData;return t.append("CampaignId",67),t.append("Code",e.userid),t.append("Name",e.name),t.append("Address",e.address),t.append("IdcardFront",e.IdcardFront),t.append("IdcardBack",e.IdcardBack),t.append("Bankbook",e.Bankbook),t.append("Certificate",e.CertificatePhoto),t.append("reCaptcha",e.reCaptcha),t.append("FBId",e.fbData.fb_id),$.ajax({url:"".concat(friendo_url,"comebest2/recipientinfo"),headers:{Authorization:"Bearer "+e.gToken},data:t,method:"POST",processData:!1,contentType:!1}).done(function(e){})},scrollTo:function(e){$("html,body").animate({scrollTop:$(e).offset().top},500)},popupOpen:function(){this.popuptop&&0!==this.popuptop||(this.popuptop=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)),$("body").addClass("_freeze")},popupClose:function(){var e=this;e.popup=!1,e.popPage="",e.awardList="",$("body").removeClass("_freeze"),$("html, body").scrollTop(e.popuptop),e.popuptop=0},afterEnter:function(){this.popupOpen()},gotoPage:function(e){var t=window.location.pathname;t==e||"/"==t?(this.comingsoon=!1,this.comPage=""):window.location.href=e},navfbshare:function(){return window.open("https://www.facebook.com/sharer/sharer.php?u=https://campaign.friendo.com.tw/Grapeking50th/index.html&hashtag=%23葡萄王50陪您精彩向前"),!1}},components:{comingsoon:comingsoon},mounted:function(){}}),Vue.component("comingsoon",{template:"#comingsoon",props:["start_date","mode_status"],data:function(){return{comingsoon:!1,comPage:"",start_date:"",mode_status:"",date:{total:0,days:0,hours:0,minutes:0,seconds:0}}},mounted:function(){function r(e,t){return(e=""+e).length>=t?e:r("0"+e,t)}var i=this;i.mode_status="started",i.start_date="2019/10/02 17:00:00";var s=setInterval(function(){var e=Date.parse(new Date(i.start_date))-Date.parse(new Date),t=Math.floor(e/1e3%60),o=Math.floor(e/1e3/60%60),a=Math.floor(e/36e5%24),n=Math.floor(e/864e5);i.date={total:e,days:r(n,2),hours:r(a,2),minutes:r(o,2),seconds:r(t,2)},"started"==i.mode_status&&(clearInterval(s),i.comingsoon=!1,i.comPage=""),"timeover"==i.mode_status&&(clearInterval(s),i.comingsoon=!0,i.comPage="timeover"),"comingsoon"==i.mode_status&&(i.comingsoon=!0,i.comPage="comingsoon")},1e3)}}),Vue.component("hello-world",{template:"<p>hello world</p>"});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwiJCIsImRhdGEiLCJkZXZpY2UiLCJkZXZpY2VDaGVjayIsIlZ1ZSIsImNvbmZpZyIsImRlYnVnIiwic2lsZW50IiwibWQiLCJNb2JpbGVEZXRlY3QiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJjb25zb2xlIiwibG9nIiwidG1wIiwicGFyYW1ldGVyTmFtZSIsInJlc3VsdCIsIml0ZW0iLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0ciIsImNoZWNrQ29va2llIiwic3BsaXQiLCJkb2N1bWVudCIsImNvb2tpZSIsImZvckVhY2giLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJ2ZXJzaW9uIiwib3MiLCJtYXRjaCIsImZpbmRHZXRQYXJhbWV0ZXIiLCJtZW51IiwibWl4aW4iLCJsb2FkaW5nIiwicG9wdXB0b3AiLCJyZXdhcmRTaGFrZSIsIm1iX2lkIiwidG9rZW4iLCJmYl9pZCIsImZiTmFtZSIsImZiUGljIiwiZmJQaG9uZSIsInNjb3JlIiwicGhvbmUiLCJwb3BQYWdlIiwidGlja2V0IiwiY29kZSIsInBvcHVwIiwiZ2FtZVN0ZXAiLCJhd2FyZExpc3QiLCJtb2RlIiwicmVDYXB0Y2hhIiwiZXJyb3JfbXNnIiwib3BlbkNvbWUiLCJ0b2dnbGVDbGFzcyIsInRoaXMiLCJzdGFydF9kYXRlIiwiZ2FFdmFudCIsImRhdGFMYXllciIsInB1c2giLCJ2YWwiLCJndG1EYXRhIiwibWV0aG9kcyIsInNlcnZlcl9idXN5IiwiZXZlbnQiLCJ2bSIsInNldENvb2tpZSIsInNldFRpbWUiLCJlcnJvcl9jb3UiLCJjbmFtZSIsImN2YWx1ZSIsInRpbWUiLCJkIiwiRGF0ZSIsImdldFRpbWUiLCJ0YWciLCJjb250ZW50IiwidG9VVENTdHJpbmciLCJleHBpcmVzIiwibG9nZ2VyIiwibGV2ZWwiLCJfTFRyYWNrZXIiLCJzdHJpbmdpZnkiLCJKU09OIiwicGF0aCIsIm5vdyIsImhyZWYiLCJ0aW1lc3RhbXAiLCJjaGVja09ubGluZSIsIm9uTGluZSIsImFsZXJ0IiwidXJsIiwiaGVhZGVycyIsImFqYXgiLCJjb25jYXQiLCJmcmllbmRvX3VybCIsIldlYlRva2VuIiwiZ1Rva2VuIiwicmVzIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwic3RhdGVfY2hlY2siLCJwb3N0X2RhdGEiLCJBdXRob3JpemF0aW9uIiwiZ2FtZV9zdGF0dXMiLCJtb2RlX3N0YXR1cyIsImdldFN0YXR1cyIsImZiRGF0YSIsIm5hbWUiLCJwaWNfdXJsIiwicmVnaXN0ZXIiLCJmYnNoYXJlIiwibWV0aG9kIiwic2F2ZVBob25lIiwidXNlciIsInBsYXlUaWNrZXQiLCJ0b3RhbCIsInJlY29yZCIsInBsYXkiLCJpbnZfbnVtIiwidG9VcHBlckNhc2UiLCJpbnZvaWNlU2F2ZSIsImNlbGwiLCJtb2JpbGUiLCJyYW5kb21fbnVtYmVyIiwiaW52X3JhbmRvbSIsImludl9kYXRlIiwiYWN0VG9rZW4iLCJjYXB0Y2hhIiwiZG9uZSIsImdyZWNhcHRjaGEiLCJfZ3JlY2FwdGNoYSIsIl94IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJ0b1N0cmluZyIsInBhZ2UiLCJleGVjdXRlIiwicmVzb2x2ZSIsInJlamVjdCIsImdldFJlY2lwaWVudGluZm8iLCJ1c2VyaWQiLCJyZWZlcmVuY2VJbmZvIiwiYXdhcmRpdGVtIiwidHlwZSIsImF3YXJkTmFtZSIsInBsb2FkaW5nIiwicmVmZXJlbmNlVHlwZSIsInBvc3RSZWNpcGllbnRpbmZvIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJhZGRyZXNzIiwiSWRjYXJkRnJvbnQiLCJJZGNhcmRCYWNrIiwiQmFua2Jvb2siLCJDZXJ0aWZpY2F0ZVBob3RvIiwicHJvY2Vzc0RhdGEiLCJzY3JvbGxUbyIsImUiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwib2Zmc2V0IiwidG9wIiwicG9wdXBPcGVuIiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJib2R5IiwiYWRkQ2xhc3MiLCJwb3B1cENsb3NlIiwicmVtb3ZlQ2xhc3MiLCJhZnRlckVudGVyIiwiZ290b1BhZ2UiLCJ0aGlzUGFnZSIsInBhdGhuYW1lIiwiY29taW5nc29vbiIsImNvbVBhZ2UiLCJvcGVuIiwibW91bnRlZCIsImNvbXBvbmVudCIsInRlbXBsYXRlIiwicHJvcHMiLCJkYXlzIiwiaG91cnMiLCJtaW51dGVzIiwic2Vjb25kcyIsInBhZExlZnQiLCJzdHIiLCJsZW4iLCJsZW5ndGgiLCJ0aW1laW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInQiLCJwYXJzZSIsIk1hdGgiLCJmbG9vciIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJhQUFBLElBQ0lBLFdBQTBDLFVBQTdCQyxFQUFFLFVBQVVDLEtBQUssUUFBOUJGLFlBQWNDLEVBQUMsVUFBVUMsS0FBSyxRQUc1QkMsT0FBU0MsY0FHZkMsSUFBSUMsT0FBT0MsVUFBU1AsV0FDcEJLLElBQUlDLE9BQU9FLE9BQVNSLFdBRXBCSyxJQUFJSSxPQUFLRCxRQUFJRSxXQUliVCxJQUFFUSxHQUFBLElBQUFDLGFBQVlDLE9BQUFDLFVBQUFDLFdBRVZDLElBQVFDLFNBQUlaLGNBQVosVUFhUSxTQUFJYSxpQkFBV0MsR0FMdkIsSUFBQUMsRUFBQSxLQVFBRixFQUFPRSxHQVVLQyxPQVRmQyxTQUFBQyxPQVJRQyxPQUFPLEdBVVBDLE1BQUFBLEtBQ0RMLFFBQVMsU0FBYkMsSUFDVUgsRUFEVkcsRUFBQUssTUFBQSxNQUVhQyxLQUFTQyxJQUNUUixFQUNSUyxtQkFBd0JYLEVBQUEsT0FFYkUsRUFFUkYsU0FBR08sWUFBY04sR0FDakIsSUFBSUQsRUFBQSxLQU5aQSxFQUFBLEdBY0EsT0FMQVMsU0FBQUMsT0FDSEYsTUFBQSxLQVRRRyxRQUFRLFNBQVVSLEdBVUosS0FBZGYsRUFBVHdCLE9BQXVCLEtBQ05ULEVBQWJBLEVBQUFVLFVBQUEsS0FQUWIsRUFBTUcsRUFBS0ssTUFBTSxNQVNaLEtBQWJQLElBQ2dCQyxFQUFaRixFQUFBLE1BRUdFLEVBRUhmLFNBQUFBLGNBRkcsSUFBQUEsRUFHQSxHQUNIQSxFQUFB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QUVQLE9BRE5GLEVBQVUsR0FBQUMsR0FDVkUsUUFBQUQsRUFFV0QsRUFBUEQsRUFBQSxJQUFBQyxFQUFBQyxHQUpaVixJQU9TaEgsRUFBQVYsS0FPTFUsRUFBQXdDLFlBQUEsVUFDQXhDLEVBQUFULFdBQUEsc0JBSUEsSUFBQXFJLEVBQUFDLFlBQUEsV0FDQSxJQUFBQyxFQUFBdEgsS0FBQXVILE1BQUEsSUFBQXZILEtBQUFSLEVBQUFULGFBQUFpQixLQUFBdUgsTUFBQSxJQUFBdkgsTUFHUStHLEVBQVVTLEtBQUtDLE1BQU9ILEVBQUksSUFBUSxJQUZ0Q0YsRUFBZUMsS0FBQUEsTUFBWUMsRUFBQSxJQUFZLEdBQUEsSUFDL0J0SCxFQUFBd0gsS0FBZXhILE1BQU9zSCxFQUFDdkksS0FBb0J3SSxJQUMvQ1IsRUFBVVMsS0FBS0MsTUFBUUgsRUFBRyxPQUMxQlIsRUFBQUEsS0FBVVUsQ0FDTDdFLE1BQVE4RSxFQUNUYixLQUFRYSxFQUFPYixFQUFJLEdBQ2pCQyxNQUFBRyxFQUFBSCxFQUFBLEdBQ05DLFFBRE1FLEVBQUFGLEVBQUEsR0FFRUUsUUFBUUosRUFGVkcsRUFBQSxJQUlZLFdBQWxCdkgsRUFBV3dILGNBQ1hVLGNBQW1CWCxHQUx2QnZILEVBQUE2RyxZQUFBLEVBVUk3RyxFQUFHOEcsUUFBVSxJQUZBLFlBQWJvQixFQUFBQSxjQUNHckIsY0FBSGUsR0FDR2QsRUFBSEQsWUFBQSxFQU1BN0csRUFBRzhHLFFBQVUsWUFIQSxjQUFib0IsRUFBQUEsY0FDR3JCLEVBQUFBLFlBQ0gsRUFDR0MsRUFBSEEsUUFBYSxlQU9sQixRQURFN0ssSUFBQWdMLFVBQUEsY0FBQSxDQUNKQyxTQUNEIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0XHJcbiAgICBwcm9kdWN0aW9uID0gJChcIiNhcHBqc1wiKS5kYXRhKFwibW9kZVwiKSA9PT0gXCJmYWxzZVwiLFxyXG4gICAgZnJpZW5kb191cmwgPSAkKFwiI2FwcGpzXCIpLmRhdGEoXCJzaXRlXCIpO1xyXG5cclxuY29uc3QgZGV2aWNlID0gZGV2aWNlQ2hlY2soKTtcclxuXHJcblZ1ZS5jb25maWcuZGV2dG9vbHMgPSAhcHJvZHVjdGlvbjtcclxuVnVlLmNvbmZpZy5kZWJ1ZyA9ICFwcm9kdWN0aW9uO1xyXG5WdWUuY29uZmlnLnNpbGVudCA9ICFwcm9kdWN0aW9uO1xyXG5cclxudmFyIG1kID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcblxyXG52YXIgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwidjEuMFwiKTtcclxuICAgIGNvbnNvbGUubG9nKGRldmljZSk7XHJcbiAgICAkKFwiLm5hdlwiKS5tZW51KCk7XHJcbn0pO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGZpbmRHZXRQYXJhbWV0ZXIocGFyYW1ldGVyTmFtZSkge1xyXG4gICAgdmFyIHJlc3VsdCA9IG51bGwsXHJcbiAgICAgICAgdG1wID0gW107XHJcbiAgICBsb2NhdGlvbi5zZWFyY2hcclxuICAgICAgICAuc3Vic3RyKDEpXHJcbiAgICAgICAgLnNwbGl0KFwiJlwiKVxyXG4gICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgIHRtcCA9IGl0ZW0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICBpZiAodG1wWzBdID09PSBwYXJhbWV0ZXJOYW1lKVxyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZGVjb2RlVVJJQ29tcG9uZW50KHRtcFsxXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja0Nvb2tpZShwYXJhbWV0ZXJOYW1lKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gbnVsbCxcclxuICAgICAgICB0bXAgPSBbXTtcclxuICAgIHZhciBjb29raWUgPSBkb2N1bWVudC5jb29raWU7XHJcbiAgICBjb29raWUuc3BsaXQoXCI7XCIpXHJcbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uY2hhckF0KDApID09IFwiIFwiKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtID0gaXRlbS5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdG1wID0gaXRlbS5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICAgIGlmICh0bXBbMF0gPT09IHBhcmFtZXRlck5hbWUpXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0bXBbMV07XHJcbiAgICAgICAgfSlcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuZnVuY3Rpb24gZGV2aWNlQ2hlY2soKSB7XHJcbiAgICB2YXIgZGV2aWNlID0ge307XHJcbiAgICB2YXIgbWQgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxuICAgIGlmIChtZC5tYXRjaCgvYW5kcm9pZC9pKSkge1xyXG4gICAgICAgIGRldmljZS5vcyA9IFwiYW5kcm9pZFwiO1xyXG4gICAgICAgIGRldmljZS52ZXJzaW9uID0gbWQudmVyc2lvbihcImFuZHJvaWRcIik7XHJcbiAgICB9IGVsc2UgaWYgKG1kLm1hdGNoKC8oaXBob25lfGlwYWR8aXBvZCk7Py9pKSkge1xyXG4gICAgICAgIGRldmljZS5vcyA9IFwiaW9zXCI7XHJcbiAgICAgICAgZGV2aWNlLnZlcnNpb24gPSBtZC52ZXJzaW9uKFwiaU9TXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkZXZpY2Uub3MgPSBcInBjXCI7XHJcbiAgICAgICAgZGV2aWNlLnZlcnNpb24gPSBtZC52ZXJzaW9uKFwiQ2hyb21lXCIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRldmljZTtcclxufVxyXG5WdWUubWl4aW4oe1xyXG4gICAgZGF0YTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN0YXR1czogXCJcIixcclxuICAgICAgICAgICAgLy8gc3RhcnRfZGF0ZTogXCJcIixcclxuICAgICAgICAgICAgZXJyb3JfbXNnOiBcIlwiLFxyXG4gICAgICAgICAgICAvLyBtb2RlOiBwcm9kdWN0aW9uID8gXCJTdGFydGVkXCIgOiBcIlRlc3RpbmdcIixcclxuICAgICAgICAgICAgLy8gbW9kZV9zdGF0dXM6IFwiXCIsXHJcbiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICBwb3B1cHRvcDogXCJcIixcclxuICAgICAgICAgICAgbmF2SGVpZ2h0OiBcIlwiLFxyXG4gICAgICAgICAgICByZXdhcmRTaGFrZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGluZUhyZWY6ICcnLFxyXG4gICAgICAgICAgICBnVG9rZW46IFwiXCIsXHJcbiAgICAgICAgICAgIExvZ286IFwiXCIsXHJcbiAgICAgICAgICAgIGZiRGF0YToge1xyXG4gICAgICAgICAgICAgICAgbWJfaWQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB0b2tlbjogXCJcIixcclxuICAgICAgICAgICAgICAgIGZiX2lkOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgZmJOYW1lOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgZmJQaWM6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBmYlBob25lOiBcIlwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB1c2VyOiB7XHJcbiAgICAgICAgICAgICAgICBwaG9uZTogXCJcIixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGxheToge1xyXG4gICAgICAgICAgICAgICAgdGlja2V0OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgY29kZTogXCJcIixcclxuICAgICAgICAgICAgICAgIHNjb3JlOiAwXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHBvcHVwOiBmYWxzZSxcclxuICAgICAgICAgICAgcG9wUGFnZTogXCJcIixcclxuICAgICAgICAgICAgZ2FtZVN0ZXA6IFwiXCIsXHJcbiAgICAgICAgICAgIGF3YXJkTGlzdDogXCJcIixcclxuICAgICAgICAgICAgcmVDYXB0Y2hhOiBcIlwiLFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjb21wdXRlZDoge1xyXG4gICAgICAgIG9wZW5Db21lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhKHRoaXMubW9kZSA9PSBcIlRlc3RpbmdcIiB8fCBzdGFydF9kYXRlIDw9IDApO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB3YXRjaDoge1xyXG4gICAgICAgIGVycm9yX21zZzogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ19mcmVlemUnKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgbWV0aG9kczoge1xyXG4gICAgICAgIGdhRXZhbnQ6IGZ1bmN0aW9uIChndG1EYXRhKSB7XHJcbiAgICAgICAgICAgIGRhdGFMYXllci5wdXNoKHsnZXZlbnQnOiBndG1EYXRhfSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2E6XCIsIGd0bURhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2VydmVyX2J1c3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0uZXJyb3JfbXNnID0gXCLns7vntbHlv5nnoozkuK3vvIzoq4vnqI3lvozlnKjoqaYhXCI7XHJcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdm0uZXJyb3JfY291ID0gNjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldENvb2tpZTogZnVuY3Rpb24gKGNuYW1lLCBjdmFsdWUsIHRpbWUpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyAodGltZSAqIDEwMDApKTtcclxuICAgICAgICAgICAgdmFyIGV4cGlyZXMgPSBcImV4cGlyZXM9XCIgKyBkLnRvVVRDU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNuYW1lICsgXCI9XCIgKyBjdmFsdWUgKyBcIjtcIiArIGV4cGlyZXMgKyBcIjtcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvZ2dlcjogZnVuY3Rpb24gKGxldmVsLCBjb250ZW50LCB0YWcpIHtcclxuICAgICAgICAgICAgaWYgKHByb2R1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIGxldmVsIDogWydFUlJPUicgPT4gMCwgREVCVUcnID0+IDEsICdXQVJOSU5HJyA9PiAyLCAnSU5GTycgPT4gMywgJ0FMTCcgPT4gNF1cclxuICAgICAgICAgICAgICAgIHZhciBsZXZlbF9pbmZvID0gWydFUlJPUicsICdERUJVRycsICdXQVJOSU5HJywgJ0lORk8nLCAnQUxMJ107XHJcbiAgICAgICAgICAgICAgICBfTFRyYWNrZXIucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ2xldmVsJzogbGV2ZWxfaW5mb1tsZXZlbF0sXHJcbiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQnOiBKU09OLnN0cmluZ2lmeShjb250ZW50KSxcclxuICAgICAgICAgICAgICAgICAgICAncGF0aCc6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxyXG4gICAgICAgICAgICAgICAgICAgICd0YWcnOiB0YWcgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAnZGV2aWNlJzogZGV2aWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOiBEYXRlLm5vdygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3JEb25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JfbXNnID0gXCJcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNoZWNrT25saW5lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghbmF2aWdhdG9yLm9uTGluZSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJJbnRlcm5ldCDpgKPnt5rlt7LmlrfplovvvIzoq4vnorroqo3mgqjnmoTntrLot6/ni4DmhYvjgIJcIik7XHJcbiAgICAgICAgICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vPT09YXBp5Y2APT09Ly9cclxuICAgICAgICBnZXRUb2tlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgLy8gdXJsOiBcImh0dHBzOi8vY2FycmVmb3VyMjAxOWNueS5henVyZXdlYnNpdGVzLm5ldC9hcGkvYXV0aC9sb2dpbj9wcm9qZWN0SWQ9NjFcIixcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9YXV0aC9sb2dpbj9wcm9qZWN0SWQ9NjdgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiV2ViVG9rZW5cIjogXCJ1K0Z3NndxUDVUZ24rdHhsZ0NsVytnPT1cIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwidG9rZW46XCIscmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5nVG9rZW4gPSByZXMudG9rZW47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RhdGVfY2hlY2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwibWJfaWRcIjogdm0uZmJEYXRhLm1iX2lkLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgLy8gdXJsOiBgJHtmcmllbmRvX3VybH1HZXRQcm9qZWN0SW5mb2AsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfWNvbWViZXN0Mi9nZXRzdGF0dXNgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIkJlYXJlciBcIisgdm0uZ1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJzdGF0ZVwiLHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmdhbWVfc3RhdHVzID09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubW9kZV9zdGF0dXMgPSBcInRpbWVvdmVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHJlcy5kYXRhLmdhbWVfc3RhdHVzID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubW9kZV9zdGF0dXMgPSBcImNvbWluZ3Nvb25cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0uc3RhcnRfZGF0ZSA9IHJlcy5kYXRhLnN0YXJ0X2RhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubW9kZV9zdGF0dXMgPSBcInN0YXJ0ZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFN0YXR1czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcIm1iX2lkXCI6IHZtLmZiRGF0YS5tYl9pZCxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogYCR7ZnJpZW5kb191cmx9R2V0UHJvamVjdEluZm9gLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1jb21lYmVzdDIvZ2V0c3RhdHVzYCxcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogXCJCZWFyZXIgXCIrIHZtLmdUb2tlbixcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBwb3N0X2RhdGEsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2V0U3RhdHVzXCIscmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYkRhdGEuZmJOYW1lID0gcmVzLmRhdGEubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYkRhdGEuZmJQaWMgPSByZXMuZGF0YS5waWNfdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmZiRGF0YS5mYlBob25lID0gcmVzLmRhdGEucGhvbmU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICByZWdpc3RlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcInRva2VuXCI6IHZtLmZiRGF0YS50b2tlbixcclxuICAgICAgICAgICAgICAgIFwiZmJfaWRcIjogdm0uZmJEYXRhLmZiX2lkLFxyXG4gICAgICAgICAgICAgICAgLy8gXCJ0b2tlblwiOiBcIkVBQUdJemZ4amNDQUJBS0owQzZXZWlHdGlHc1BpeE9ZV1d6TTZnaFg0eXJIWkFmZktwOUtaQjFyb0Q1RU02ZHNvWWxZcTZMTWVLa0FTd3RJRjdYVlVvdFZIU0d5U21xTDZGenF4WkNGeWVzSGZ2bDFtcjR4dW9nQlNDYVpCTjVER3lJV3FUalRRUldqWHB2VU5PWkFmQlpDWkFCTm5Fb01jRHk3NDRhN1pDUHV0TEZIM2h1ZHVsNWRGMjZ4dFh3VVpDdU5YRHNQc2hCV0RpajZZeDFOS1pDQzdEdkZkNGh4aFpDUzNtRkwydmpUY0RBdWpnWkRaRFwiLFxyXG4gICAgICAgICAgICAgICAgLy8gXCJmYl9pZFwiOiBcIjI2NjQ4NjE2NzM1MjQ2OTJcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgLy8gdXJsOiBgJHtmcmllbmRvX3VybH1HZXRQcm9qZWN0SW5mb2AsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfWNvbWViZXN0Mi9yZWdpc3RlcmAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1iX2lkXCIscmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mYkRhdGEubWJfaWQgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZic2hhcmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJtYl9pZFwiOiB2bS5mYkRhdGEubWJfaWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogYCR7ZnJpZW5kb191cmx9R2V0UHJvamVjdEluZm9gLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1jb21lYmVzdDIvZmJzaGFyZWAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImZic2hhcmVcIixyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZtLmZiRGF0YS5tYl9pZCA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2F2ZVBob25lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwibWJfaWRcIjogdm0uZmJEYXRhLm1iX2lkLFxyXG4gICAgICAgICAgICAgICAgXCJwaG9uZVwiOiB2bS51c2VyLnBob25lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IGAke2ZyaWVuZG9fdXJsfUdldFByb2plY3RJbmZvYCxcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9Y29tZWJlc3QyL3NhdmVwaG9uZWAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInNhdmVwaG9uZVwiLHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdm0uZmJEYXRhLm1iX2lkID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwbGF5VGlja2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIFwibWJfaWRcIjogdm0uZmJEYXRhLm1iX2lkLFxyXG4gICAgICAgICAgICAgICAgLy8gXCJwaG9uZVwiOiB2bS51c2VyLnBob25lXHJcbiAgICAgICAgICAgICAgICBcInNjb3JlXCI6IHZtLnRvdGFsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IGAke2ZyaWVuZG9fdXJsfUdldFByb2plY3RJbmZvYCxcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9Y29tZWJlc3QyL3BsYXlgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIkJlYXJlciBcIisgdm0uZ1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwbGF5XCIscmVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlY29yZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcIm1iX2lkXCI6IHZtLmZiRGF0YS5tYl9pZCxcclxuICAgICAgICAgICAgICAgIFwidGlja2V0XCI6IHZtLnBsYXkudGlja2V0LFxyXG4gICAgICAgICAgICAgICAgXCJzY29yZVwiOiB2bS5wbGF5LnNjb3JlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IGAke2ZyaWVuZG9fdXJsfUdldFByb2plY3RJbmZvYCxcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9Y29tZWJlc3QyL3JlY29yZGAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInJlY29yZFwiLHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b3AxMDA6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgXCJtYl9pZFwiOiB2bS5mYkRhdGEubWJfaWQsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IGAke2ZyaWVuZG9fdXJsfUdldFByb2plY3RJbmZvYCxcclxuICAgICAgICAgICAgICAgIHVybDogYCR7ZnJpZW5kb191cmx9Y29tZWJlc3QyL3RvcDEwMGAsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInRvcDEwMFwiLHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbnZvaWNlU2F2ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBcImNlbGxcIjogdm0ubW9iaWxlLFxyXG4gICAgICAgICAgICAgICAgXCJpbnZfbnVtXCI6IHZtLmludl9udW0udG9VcHBlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgIFwicmFuZG9tX251bWJlclwiOiB2bS5pbnZfcmFuZG9tLFxyXG4gICAgICAgICAgICAgICAgXCJpbnZfZGF0ZVwiOiB2bS5pbnZfZGF0ZSxcclxuICAgICAgICAgICAgICAgIFwiYWN0VG9rZW5cIiA6IFwiVGU4UnZPNlpsRWphSkp0VGV0SDhNZz09XCIsXHJcbiAgICAgICAgICAgICAgICBcImNhcHRjaGFcIjogdm0ucmVDYXB0Y2hhXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAvLyB1cmw6IFwiaHR0cHM6Ly9kZXZlbG9wYXBpLmF6dXJld2Vic2l0ZXMubmV0L2FwaS9pbnZvaWNlL3NhdmVkYXRhXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGAke2ZyaWVuZG9fdXJsfWludm9pY2Uvc2F2ZWRhdGFgLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIkJlYXJlciBcIisgdm0uZ1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHBvc3RfZGF0YSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCJcclxuICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJpbnZvcmVzOlwiLHJlcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0YXdhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogYCR7ZnJpZW5kb191cmx9R2V0UHJvamVjdEluZm9gLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1jb21lYmVzdDIvTG90dGVyeVJlc3VsdC82N2AsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgLy8gZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldGF3YXJkXCIscmVzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyZWNhcHRjaGE6IGZ1bmN0aW9uKHBhZ2UpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2luJykgXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBncmVjYXB0Y2hhLmV4ZWN1dGUoJzZMZDU0TE1VQUFBQUFLbmhjNUZrWklDSjRpb1NsRjd0NW9mTWcwTmcnLCB7IGFjdGlvbjogcGFnZSB9KS50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnJlQ2FwdGNoYSA9IHRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKVxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgeyBcclxuICAgICAgICAgICAgICAgICAgICBhbGVydCgnR29vZ2xl6amX6K2J5aSx5pWX77yM6KuL5YaN5qyh5ZiX6KmmXFxu5aaC54Sh5rOV5o6S6Zmk5q2k5ZWP6aGM77yM5bu66K2w6YeN5paw5pW055CG5q2k6aCB6Z2iJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFJlY2lwaWVudGluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIC8vIHVybDogYCR7ZnJpZW5kb191cmx9R2V0UHJvamVjdEluZm9gLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1jb21lYmVzdDIvcmVjaXBpZW50aW5mby8ke3ZtLnVzZXJpZH1gLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBcIkJlYXJlciBcIisgdm0uZ1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgICAgIC8vIGRhdGFUeXBlOiBcImpzb25cIiwgXHJcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwicmVjaXBpZW50aW5mb1wiLHJlcyk7XHJcbiAgICAgICAgICAgICAgICBpZighcmVzLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuizh+aWmeW3suWbnuWhq+aIlueEoeazleafpeeNsuatpOeNjumghVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiLi9pbmRleC5odG1sXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ucGxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubW9iaWxlID0gcmVzLmRhdGEubW9iaWxlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmludl9udW0gPSByZXMuZGF0YS5yZWZlcmVuY2VJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmF3YXJkaXRlbSA9IHJlcy5kYXRhLmF3YXJkTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS50eXBlID0gcmVzLmRhdGEucmVmZXJlbmNlVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wbG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9zdFJlY2lwaWVudGluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJDYW1wYWlnbklkXCIsNjcpXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJDb2RlXCIsdm0udXNlcmlkKVxyXG4gICAgICAgICAgICBwb3N0X2RhdGEuYXBwZW5kKFwiTmFtZVwiLHZtLm5hbWUpXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJBZGRyZXNzXCIsdm0uYWRkcmVzcylcclxuICAgICAgICAgICAgcG9zdF9kYXRhLmFwcGVuZChcIklkY2FyZEZyb250XCIsdm0uSWRjYXJkRnJvbnQpXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJJZGNhcmRCYWNrXCIsdm0uSWRjYXJkQmFjaylcclxuICAgICAgICAgICAgcG9zdF9kYXRhLmFwcGVuZChcIkJhbmtib29rXCIsdm0uQmFua2Jvb2spXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJDZXJ0aWZpY2F0ZVwiLHZtLkNlcnRpZmljYXRlUGhvdG8pXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJyZUNhcHRjaGFcIix2bS5yZUNhcHRjaGEpXHJcbiAgICAgICAgICAgIHBvc3RfZGF0YS5hcHBlbmQoXCJGQklkXCIsdm0uZmJEYXRhLmZiX2lkKVxyXG4gICAgICAgICAgICAvLyB2YXIgcG9zdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAvLyAgICAgXCJDYW1wYWlnbklkXCI6IDY2LFxyXG4gICAgICAgICAgICAvLyAgICAgXCJDb2RlXCI6IHZtLnVzZXJpZCxcclxuICAgICAgICAgICAgLy8gICAgIFwiTmFtZVwiOiB2bS5uYW1lLFxyXG4gICAgICAgICAgICAvLyAgICAgXCJBZGRyZXNzXCI6IHZtLmFkZHJlc3MsXHJcbiAgICAgICAgICAgIC8vICAgICBcIklkY2FyZEZyb250XCI6IHZtLklkY2FyZEZyb250LFxyXG4gICAgICAgICAgICAvLyAgICAgXCJJZGNhcmRCYWNrXCI6IHZtLklkY2FyZEJhY2ssXHJcbiAgICAgICAgICAgIC8vICAgICBcIkJhbmtib29rXCI6IHZtLkJhbmtib29rLFxyXG4gICAgICAgICAgICAvLyAgICAgXCJDZXJ0aWZpY2F0ZVwiOiB2bS5DZXJ0aWZpY2F0ZVBob3RvLFxyXG4gICAgICAgICAgICAvLyAgICAgXCJyZUNhcHRjaGFcIjogdm0ucmVDYXB0Y2hhXHJcbiAgICAgICAgICAgIC8vIH07XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtmcmllbmRvX3VybH1jb21lYmVzdDIvcmVjaXBpZW50aW5mb2AsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB2bS5nVG9rZW4sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogcG9zdF9kYXRhLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIC8vIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJwb3N0UmVjaXBpZW50aW5mbzpcIixyZXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy89PT3lip/og73ljYA9PT0vL1xyXG4gICAgICAgIHNjcm9sbFRvOiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyB2bS5yb29tID0gbnVsbDtcclxuICAgICAgICAgICAgLy8gdm0uYWxsUG9wdXBDbG9zZSgpO1xyXG4gICAgICAgICAgICAkKFwiaHRtbCxib2R5XCIpLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKGUpLm9mZnNldCgpLnRvcFxyXG4gICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9wdXBPcGVuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghdm0ucG9wdXB0b3AgfHwgdm0ucG9wdXB0b3AgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHZtLnBvcHVwdG9wID0gTWF0aC5tYXgod2luZG93LnBhZ2VZT2Zmc2V0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdfZnJlZXplJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwb3B1cENsb3NlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZtLnBvcFBhZ2UgPSBcIlwiO1xyXG4gICAgICAgICAgICB2bS5hd2FyZExpc3QgPSBcIlwiO1xyXG4gICAgICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ19mcmVlemUnKTtcclxuICAgICAgICAgICAgJCgnaHRtbCwgYm9keScpLnNjcm9sbFRvcCh2bS5wb3B1cHRvcCk7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwdG9wID0gMDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFmdGVyRW50ZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucG9wdXBPcGVuKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnb3RvUGFnZTogZnVuY3Rpb24ocGFnZSkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgdGhpc1BhZ2UgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XHJcbiAgICAgICAgICAgIGlmKHRoaXNQYWdlID09IHBhZ2UgfHwgdGhpc1BhZ2UgPT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5jb21pbmdzb29uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2bS5jb21QYWdlID0gXCJcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcGFnZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbmF2ZmJzaGFyZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCdodHRwczovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT0nK1wiaHR0cHM6Ly9jYW1wYWlnbi5mcmllbmRvLmNvbS50dy9HcmFwZWtpbmc1MHRoL2luZGV4Lmh0bWxcIisnJmhhc2h0YWc9JTIzJysn6JGh6JCE546LNTDpmarmgqjnsr7lvanlkJHliY0nKTtyZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBjb21wb25lbnRzOiB7XHJcbiAgICAgICAgY29taW5nc29vbjogY29taW5nc29vblxyXG4gICAgfSxcclxuICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICBcclxuICAgICAgICAvLyDmuKzoqabnlKhcclxuICAgICAgICAvLyB2bS5zdGFydF9kYXRlID0gXCIyMDE5LzEwLzAxIDEyOjAwOjAwXCI7XHJcbiAgICAgICAgLy8gdm0ubW9kZV9zdGF0dXMgPSBcInN0YXJ0ZWRcIiAvLyBzdGFydGVkICB0aW1lb3ZlciAgY29taW5nc29vblxyXG4gICAgfVxyXG59KVxyXG5cclxuXHJcblZ1ZS5jb21wb25lbnQoJ2NvbWluZ3Nvb24nLCB7XHJcbiAgICB0ZW1wbGF0ZTogXCIjY29taW5nc29vblwiLFxyXG4gICAgcHJvcHM6IFsnc3RhcnRfZGF0ZScsICdtb2RlX3N0YXR1cyddLCAvL3Z1ZeWcqOi8ieWFpeaZgu+8jOacg+WFiOaKiuWtkOWxpOeahOWFg+S7tuaOm+i8ieS4iuWOu++8jOacg+mAoOaIkOeItuWxpOeahOiuiuaVuOizh+aWmeaYr+aykuacieWAvOeahOeLgOaFi1xyXG4gICAgZGF0YTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNvbWluZ3Nvb246IGZhbHNlLFxyXG4gICAgICAgICAgICBjb21QYWdlOiBcIlwiLFxyXG4gICAgICAgICAgICBzdGFydF9kYXRlOiBcIlwiLFxyXG4gICAgICAgICAgICBtb2RlX3N0YXR1czogXCJcIixcclxuICAgICAgICAgICAgZGF0ZToge1xyXG4gICAgICAgICAgICAgICAgdG90YWw6IDAsXHJcbiAgICAgICAgICAgICAgICBkYXlzOiAwLFxyXG4gICAgICAgICAgICAgICAgaG91cnM6IDAsXHJcbiAgICAgICAgICAgICAgICBtaW51dGVzOiAwLFxyXG4gICAgICAgICAgICAgICAgc2Vjb25kczogMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgIFxyXG4gICAgfSxcclxuICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcGFkTGVmdCA9IGZ1bmN0aW9uIChzdHIsIGxlbikge1xyXG4gICAgICAgICAgICBzdHIgPSAnJyArIHN0cjtcclxuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGggPj0gbGVuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhZExlZnQoXCIwXCIgKyBzdHIsIGxlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgLy8gdm0uZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gICAgIHZtLnN0YXRlX2NoZWNrKCkudGhlbihmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vICAgICAgICAgdm0ubW9kZV9zdGF0dXMgPSBcInN0YXJ0ZWRcIjtcclxuICAgICAgICAvLyAgICAgICAgIHZtLnN0YXJ0X2RhdGUgPSBcIjIwMTkvMTAvMDIgMTc6MDA6MDBcIlxyXG4gICAgICAgIC8vICAgICB9KVxyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIHZtLm1vZGVfc3RhdHVzID0gXCJzdGFydGVkXCI7XHJcbiAgICAgICAgdm0uc3RhcnRfZGF0ZSA9IFwiMjAxOS8xMC8wMiAxNzowMDowMFwiXHJcbiAgICAgICAgLy8gdm0uc3RhdGVfY2hlY2soKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAvLyAgICAgdmFyIGRhdGEgPSByZXMuRGF0YTtcclxuICAgICAgICAvLyAgICAgdm0uc3RhcnRfZGF0ZSA9IGRhdGEuU3RhcnREYXRlVGltZTtcclxuICAgICAgICB2YXIgdGltZWludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9IERhdGUucGFyc2UobmV3IERhdGUodm0uc3RhcnRfZGF0ZSkpIC0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKCh0IC8gMTAwMCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcigodCAvIDEwMDAgLyA2MCkgJSA2MCk7XHJcbiAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoKHQgLyAoMTAwMCAqIDYwICogNjApKSAlIDI0KTtcclxuICAgICAgICAgICAgdmFyIGRheXMgPSBNYXRoLmZsb29yKHQgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xyXG4gICAgICAgICAgICB2bS5kYXRlID0ge1xyXG4gICAgICAgICAgICAgICAgJ3RvdGFsJzogdCxcclxuICAgICAgICAgICAgICAgICdkYXlzJzogcGFkTGVmdChkYXlzLCAyKSxcclxuICAgICAgICAgICAgICAgICdob3Vycyc6IHBhZExlZnQoaG91cnMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ21pbnV0ZXMnOiBwYWRMZWZ0KG1pbnV0ZXMsIDIpLFxyXG4gICAgICAgICAgICAgICAgJ3NlY29uZHMnOiBwYWRMZWZ0KHNlY29uZHMsIDIpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmICh2bS5tb2RlX3N0YXR1cyA9PSBcInN0YXJ0ZWRcIikge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1laW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgdm0uY29taW5nc29vbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdm0uY29tUGFnZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIGlmICh2bS5tb2RlX3N0YXR1cyA9PSBcInRpbWVvdmVyXCIpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZWludGVydmFsKTtcclxuICAgICAgICAgICAgICAgIHZtLmNvbWluZ3Nvb24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gdm0uY29taW5nc29vbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdm0uY29tUGFnZSA9IFwidGltZW92ZXJcIjtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgaWYgKHZtLm1vZGVfc3RhdHVzID09IFwiY29taW5nc29vblwiKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5jb21pbmdzb29uID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vIHZtLmNvbWluZ3Nvb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZtLmNvbVBhZ2UgPSBcImNvbWluZ3Nvb25cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgfSxcclxufSlcclxuXHJcblZ1ZS5jb21wb25lbnQoJ2hlbGxvLXdvcmxkJywge1xyXG4gICAgdGVtcGxhdGU6ICc8cD5oZWxsbyB3b3JsZDwvcD4nXHJcbn0pXHJcbiJdfQ==
