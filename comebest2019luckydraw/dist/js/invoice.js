"use strict";var invisible_grecaptcha;function onloadCallback(){invisible_grecaptcha=grecaptcha.render("recaptcha",{sitekey:"6LdJ_YsUAAAAABY4BTGXKgCF4RVUVjCXwZi1aJD6",size:"invisible",callback:onSubmit})}function onSubmit(e){invoice.token=e,invoice.captchaCallback()}var invoice=new Vue({el:"#app",data:{isGyro:!1,userId:"",invForm:{name:"",phone:"",date:"10802",num:"",randomNum:"",checkagree:!1},dragLottery:"",checkPos:!1,shakePos:"",loading:!1,birth_loading:!1,birthday:{date:"",year:""},canShake:!1,shakeOK:!1,animals:0,animalItem:["kX5dJ","eA5kD","uCHkr","oZewi","CSi2I","ejzXO","HvNDO","BhTqo","UWblU","9BHZO","i2v4w","Ro2eX"],shareLink:"",formstep:"form",formbtn:"before",token:"",isGA:!1},methods:{testGyro:function(){var e=this;e.isGyro||e.lotteryEvent(),setTimeout(function(){e.lotterySuccess()},3e3)},eventGyro:function(){var n=this;window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(e){e.alpha&&(n.isGyro=!0,n.testGyro(),Draggable.get("#shakePoint").disable());document.getElementById("alpha"),document.getElementById("beta"),document.getElementById("gamma");var a=e.beta,t="";if(n.canShake){-60<e.gamma&&e.gamma<60&&(t=e.gamma);var r=document.getElementById("shakePoint");r.style.webkitTransform="translate("+t/3+"%,"+a/3+"%)",r.style.transform="translate("+t/3+"%,"+a/3+"%)",r.style.mozTransform="translate("+t/3+"%,"+a/3+"%)"}},!1)},sendInvoice:function(){var e=this;if(!e.loading){e.loading=!0;var a=e.invForm;if(""==a.name)return alert("請輸入聯絡人姓名"),void(e.loading=!1);if(""==a.phone||!a.phone.match(/^09[0-9]{8}$/))return alert("請輸入手機正確格式"),void(e.loading=!1);if(""==a.date)return alert("請選擇發票期別"),void(e.loading=!1);if(""==a.num||!a.num.match(/^[a-zA-Z]{2}[0-9]{8}$/))return alert("請輸入發票正確格式"),void(e.loading=!1);if(""==a.randomNum||!a.randomNum.match(/^[0-9]{4}$/))return alert("請輸入發票隨機碼正確格式"),void(e.loading=!1);if(!a.checkagree)return alert("請勾選同意說明"),void(e.loading=!1);grecaptcha.execute()}},captchaCallback:function(){var a=this;a.SaveInvoice().then(function(e){a.loading=!1,2e3===e.errorCode?(a.gaEvant("發票登錄_成功登錄"),a.userId=e.data.member_id,a.scrollTo("body"),a.formstep="formover",a.birthInit()):(alert(e.errorMsg),grecaptcha.reset(invisible_grecaptcha),a.invForm.num="",a.invForm.randomNum="",a.invForm.checkagree=!1)})},birthInit:function(){$("#birthday").dateDropdowns({defaultDate:"1999-01-01",displayFormat:"ymd",maxAge:100,monthFormat:"numeric",monthSuffixes:!1,daySuffixes:!1,required:!0,wrapperClass:"select-birthday"}),$(".select-birthday .year").after('<label for="year"> 年</label>'),$(".select-birthday .month").after('<label for="month"> 月</label>'),$(".select-birthday .day").after('<label for="day"> 日</label>')},birthPop:function(){var e=this;e.popupOpen(),e.popuppage="birthday",e.popup=!0},SaveInvoice:function(){var a=this,e={user_name:a.invForm.name,cell:a.invForm.phone,inv_date:a.invForm.date,inv_num:a.invForm.num.toUpperCase(),random_number:a.invForm.randomNum};return $.ajax({url:apiUrl+"/invoiceEntry",method:"POST",headers:{"Verify-Token":a.token},error:function(e){alert("系統忙碌中，請稍後再試!"),grecaptcha.reset(invisible_grecaptcha),a.loading=!1},data:e,dataType:"json"})},lotteryEvent:function(){var a=this,t=[],r=60,n=!1,i=!1;isMobile&&(r=0),a.dragLottery=Draggable.create("#shakePoint",{type:"x",edgeResistance:.65,bounds:".fortune-area",throwProps:!0,autoScroll:!0,onDragStart:function(e){t[0]=e.clientX-r,t[1]=e.clientX+e.srcElement.clientWidth+r,$(".l-container ").css("overflow-x","hidden"),a.gaEvant("發票登錄_點住按鈕")},onDrag:function(e){e.clientX<t[0]?n=!0:e.clientX>t[1]&&(i=!0)},onDragEnd:function(){$(".l-container ").css("overflow-x","inherit"),isMobile?a.lotterySuccess():n&&i&&a.lotterySuccess()}})},lotterySuccess:function(){$(".fortune-area").addClass("active")},SaveBirthday:function(){var e={member_id:this.userId,birthday:this.birthday.date};return $.ajax({url:apiUrl+"/memberBirthday",method:"POST",error:function(e){alert("系統忙碌中，請稍後再試!")},data:e,dataType:"json"})},sendBirthday:function(){var a=this,e=$("#birthdayForm").serializeArray();a.birthday.date=e[0].value,a.birthday.year=e[1].value,a.SaveBirthday().then(function(e){a.birth_loading=!1,2e3===e.errorCode?(a.animals=parseInt((a.birthday.year-1912)%12),a.popupClose(),a.scrollTo("body"),a.formstep="lottery",a.fortuneIssue()):alert(e.errorMsg)})},fortuneIssue:function(){var e=this;e.testGyro(),e.eventGyro(),e.canShake=!0,e.fbshare(),document.getElementById("oracale").addEventListener("animationend",function(){e.isGA||(e.gaEvant("發票登錄_搖晃抽籤"),e.isGA=!0),e.scrollTo("body"),e.formstep="lottery_over"})},fbshare:function(){var e="https://result.friendo.com.tw/"+this.animalItem[this.animals];this.shareLink="https://www.facebook.com/sharer/sharer.php?u="+e+"&hashtag=%232019能量求籤筒"},sampleOpen:function(){this.popup=!0,this.popuppage="sample"}},mounted:function(){this.cloud_Ani()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludm9pY2UuanMiXSwibmFtZXMiOlsiaW52aXNpYmxlX2dyZWNhcHRjaGEiLCJncmVjYXB0Y2hhIiwicmVuZGVyIiwic2l0ZWtleSIsImNhbGxiYWNrIiwib25TdWJtaXQiLCJyZWNhcHRjaGFfdG9rZW4iLCJpbnZvaWNlIiwidG9rZW4iLCJjYXB0Y2hhQ2FsbGJhY2siLCJlbCIsImRhdGEiLCJ1c2VySWQiLCJpbnZGb3JtIiwibmFtZSIsInBob25lIiwiZGF0ZSIsIm51bSIsInJhbmRvbU51bSIsImNoZWNrYWdyZWUiLCJzaGFrZVBvcyIsImRyYWdMb3R0ZXJ5IiwiY2hlY2tQb3MiLCJiaXJ0aF9sb2FkaW5nIiwieWVhciIsImFuaW1hbHMiLCJjYW5TaGFrZSIsInNoYWtlT0siLCJhbmltYWxJdGVtIiwic2hhcmVMaW5rIiwiZm9ybXN0ZXAiLCJpc0dBIiwidGVzdEd5cm8iLCJ2bSIsInRoaXMiLCJpc0d5cm8iLCJsb3R0ZXJ5RXZlbnQiLCJzZXRUaW1lb3V0IiwibG90dGVyeVN1Y2Nlc3MiLCJldmVudEd5cm8iLCJ3aW5kb3ciLCJEZXZpY2VPcmllbnRhdGlvbkV2ZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiYWxwaGEiLCJEcmFnZ2FibGUiLCJnZXQiLCJkaXNhYmxlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImJldGEiLCJnYW1tYSIsInRhcmdldCIsInN0eWxlIiwidHJhbnNmb3JtIiwibW96VHJhbnNmb3JtIiwic2VuZEludm9pY2UiLCJsb2FkaW5nIiwiZm9ybSIsInJhbmRvbV9ydWxlIiwicGhvbmVfcnVsZSIsIm1hdGNoIiwiYWxlcnQiLCJleGVjdXRlIiwiU2F2ZUludm9pY2UiLCJ0aGVuIiwicmVzIiwiZXJyb3JDb2RlIiwiZ2FFdmFudCIsIm1lbWJlcl9pZCIsImJpcnRoSW5pdCIsImVycm9yTXNnIiwicmVzZXQiLCIkIiwic2Nyb2xsVG8iLCJkYXRlRHJvcGRvd25zIiwibWF4QWdlIiwiYWZ0ZXIiLCJkZWZhdWx0RGF0ZSIsImRpc3BsYXlGb3JtYXQiLCJwb3B1cE9wZW4iLCJtb250aEZvcm1hdCIsIm1vbnRoU3VmZml4ZXMiLCJyZXF1aXJlZCIsIndyYXBwZXJDbGFzcyIsImludl9kYXRhIiwidXNlcl9uYW1lIiwiY2VsbCIsImludl9kYXRlIiwiaW52X251bSIsInRvVXBwZXJDYXNlIiwicmFuZG9tX251bWJlciIsImFqYXgiLCJwb3B1cHBhZ2UiLCJhcGlVcmwiLCJtZXRob2QiLCJoZWFkZXJzIiwiVmVyaWZ5LVRva2VuIiwiZSIsImRhdGFUeXBlIiwieCIsInJhbmdlIiwiY2hlY2sxIiwiY2hlY2syIiwiY3JlYXRlIiwidHlwZSIsImVkZ2VSZXNpc3RhbmNlIiwiYm91bmRzIiwidGhyb3dQcm9wcyIsImF1dG9TY3JvbGwiLCJvbkRyYWdTdGFydCIsImNsaWVudFgiLCJzcmNFbGVtZW50IiwiY2xpZW50V2lkdGgiLCJjc3MiLCJvbkRyYWciLCJpc01vYmlsZSIsImFkZENsYXNzIiwiU2F2ZUJpcnRoZGF5IiwiYmlydGhkYXkiLCJ1cmwiLCJlcnJvciIsImJpcnRoX2RhdGEiLCJzZW5kQmlydGhkYXkiLCJzZXJpYWxpemVBcnJheSIsImJpcnRoUmVzIiwidmFsdWUiLCJwYXJzZUludCIsInBvcHVwQ2xvc2UiLCJmb3J0dW5lSXNzdWUiLCJmYnNoYXJlIiwic2FtcGxlT3BlbiIsInBvcHVwIiwibW91bnRlZCJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEscUJBQUosU0FBSUEsaUJBRUpBLHFCQUEwQkMsV0FBQUMsT0FBQSxZQUFBLENBQ3RCQyxRQUFBLDJDQUNBSCxLQUFBQSxZQUNJSSxTQUFXQyxXQUR1QyxTQUF0REEsU0FBQUMsR0FLSEMsUUFBQUMsTUFBQUYsRUFHR0MsUUFBUUUsa0JBQVJGLElBQUFBLFFBQVFFLElBQUFBLElBQUFBLENBQ1hDLEdBQUEsT0FJR0MsS0FBTSxDQUZOSixRQUFVLEVBQ05LLE9BRGMsR0FFWkMsUUFBQSxDQUNNQyxLQUROLEdBRU1DLE1BRk4sR0FHS0MsS0FBRSxRQUNDQyxJQURE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LEVBQUMrRixVQUNTaEYsU0FBWkMsZUFBQSxXQUNHbkIsaUJBQUgsZUFBQSxXQUNHbUcsRUFBQUEsT0FDQWhHLEVBQUFtQyxRQUFBLGFBQ09HLEVBQUFBLE1BQVYsR0FaUnRDLEVBQUF5QyxTQUFBLFFBeE9DekMsRUFBQUgsU0FBQSxrQkF5UUxvRyxRQUFTLFdBZEZsRyxJQUNBTyxFQUFILGlDQURBTCxLQUNBTixXQURBTSxLQUNBVCxTQURBUyxLQUVHUixVQUFILGdEQUFBOEYsRUFBQSx5QkFFQVcsV0FBVW5GLFdBQ05OLEtBQ08wRixPQUFPLEVBRGQxRixLQUVPMEIsVUFBUSxXQWtCM0JpRSxRQUFTLFdBZk0zRCxLQUNBNUMiLCJmaWxlIjoiaW52b2ljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBpbnZpc2libGVfZ3JlY2FwdGNoYTtcclxuXHJcbmZ1bmN0aW9uIG9ubG9hZENhbGxiYWNrKCkge1xyXG4gICAgLy8gY29uc29sZS5sb2coXCI9PT0gb25sb2FkQ2FsbGJhY2sgPT09XCIpO1xyXG4gICAgaW52aXNpYmxlX2dyZWNhcHRjaGEgPSBncmVjYXB0Y2hhLnJlbmRlcigncmVjYXB0Y2hhJywge1xyXG4gICAgICAgICdzaXRla2V5JzogJzZMZEpfWXNVQUFBQUFCWTRCVEdYS2dDRjRSVlVWakNYd1ppMWFKRDYnLFxyXG4gICAgICAgICdzaXplJzogJ2ludmlzaWJsZScsXHJcbiAgICAgICAgJ2NhbGxiYWNrJzogb25TdWJtaXQsXHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBvblN1Ym1pdChyZWNhcHRjaGFfdG9rZW4pIHtcclxuICAgIGludm9pY2UudG9rZW4gPSByZWNhcHRjaGFfdG9rZW47XHJcbiAgICBpbnZvaWNlLmNhcHRjaGFDYWxsYmFjaygpO1xyXG59XHJcblxyXG52YXIgaW52b2ljZSA9IG5ldyBWdWUoe1xyXG4gICAgZWw6IFwiI2FwcFwiLFxyXG4gICAgZGF0YToge1xyXG4gICAgICAgIGlzR3lybzogZmFsc2UsXHJcbiAgICAgICAgdXNlcklkOiAnJyxcclxuICAgICAgICBpbnZGb3JtOiB7XHJcbiAgICAgICAgICAgIG5hbWU6ICcnLFxyXG4gICAgICAgICAgICBwaG9uZTogJycsXHJcbiAgICAgICAgICAgIGRhdGU6ICcxMDgwMicsXHJcbiAgICAgICAgICAgIG51bTogJycsXHJcbiAgICAgICAgICAgIHJhbmRvbU51bTogJycsXHJcbiAgICAgICAgICAgIGNoZWNrYWdyZWU6IGZhbHNlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZHJhZ0xvdHRlcnk6ICcnLFxyXG4gICAgICAgIGNoZWNrUG9zOiBmYWxzZSxcclxuICAgICAgICBzaGFrZVBvczogJycsXHJcbiAgICAgICAgbG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgYmlydGhfbG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgYmlydGhkYXk6IHtcclxuICAgICAgICAgICAgZGF0ZTogJycsXHJcbiAgICAgICAgICAgIHllYXI6ICcnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FuU2hha2U6IGZhbHNlLFxyXG4gICAgICAgIHNoYWtlT0s6IGZhbHNlLFxyXG4gICAgICAgIGFuaW1hbHM6IDAsXHJcbiAgICAgICAgYW5pbWFsSXRlbTogWydrWDVkSicsICdlQTVrRCcsICd1Q0hrcicsICdvWmV3aScsICdDU2kySScsICdlanpYTycsICdIdk5ETycsICdCaFRxbycsICdVV2JsVScsICc5QkhaTycsICdpMnY0dycsJ1JvMmVYJ10sXHJcbiAgICAgICAgc2hhcmVMaW5rOiAnJyxcclxuICAgICAgICBmb3Jtc3RlcDogXCJmb3JtXCIsXHJcbiAgICAgICAgZm9ybWJ0bjogXCJiZWZvcmVcIixcclxuICAgICAgICB0b2tlbjogJycsXHJcbiAgICAgICAgaXNHQTogZmFsc2UsXHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG4gICAgbWV0aG9kczoge1xyXG4gICAgICAgIHRlc3RHeXJvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICh2bS5pc0d5cm8pIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwi5pyJ6ZmA6J665YSAXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdm0ubG90dGVyeUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIuWBtea4rOS4jeWIsOmZgOieuuWEgFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZtLmxvdHRlcnlTdWNjZXNzKCk7XHJcbiAgICAgICAgICAgIH0sIDMwMDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXZlbnRHeXJvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cuRGV2aWNlT3JpZW50YXRpb25FdmVudCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RldmljZW9yaWVudGF0aW9uJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmFscGhhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIEd5cm9cclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0uaXNHeXJvID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0udGVzdEd5cm8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRHJhZ2dhYmxlLmdldChcIiNzaGFrZVBvaW50XCIpLmRpc2FibGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxwaGEnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZXRhJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtbWEnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmV0YSA9IGV2ZW50LmJldGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhbW1hID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZtLmNhblNoYWtlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmICghdm0uY2hlY2tQb3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIGZpcnN0IHBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB2bS5jaGVja1BvcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB2bS5sb3R0ZXJ5U3VjY2VzcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hha2UgaXNzdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHBvc2l0aW9uID0gZXZlbnQuYWxwaGEgKyBldmVudC5iZXRhICsgZXZlbnQuZ2FtbWE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChwb3NpdGlvbiA+IHZtLnNoYWtlUG9zICsgMzYwIHx8IHBvc2l0aW9uIDwgdm0uc2hha2VQb3MgLSAzNjApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGlmICghdm0uc2hha2VPSykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZtLnNoYWtlT0sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZtLmxvdHRlcnlTdWNjZXNzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcm90YXRlIHN0eWxlIGlzc3VlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5nYW1tYSA+IC02MCAmJiBldmVudC5nYW1tYSA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1tYSA9IGV2ZW50LmdhbW1hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hha2VQb2ludCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgZ2FtbWEvMyArICclLCcgKyBiZXRhLzMgKyAnJSknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgZ2FtbWEvMyArICclLCcgKyBiZXRhLzMgKyAnJSknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUubW96VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgZ2FtbWEvMyArICclLCcgKyBiZXRhLzMgKyAnJSknO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZW5kSW52b2ljZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXZtLmxvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBob25lX3J1bGUgPSAvXjA5WzAtOV17OH0kLztcclxuICAgICAgICAgICAgICAgIHZhciBpbnZfcnVsZSA9IC9eW2EtekEtWl17Mn1bMC05XXs4fSQvO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJhbmRvbV9ydWxlID0gL15bMC05XXs0fSQvO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvcm0gPSB2bS5pbnZGb3JtO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZvcm0ubmFtZSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLoq4vovLjlhaXoga/ntaHkurrlp5PlkI1cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGZvcm0ucGhvbmUgPT0gXCJcIiB8fCAhZm9ybS5waG9uZS5tYXRjaChwaG9uZV9ydWxlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL6Ly45YWl5omL5qmf5q2j56K65qC85byPXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChmb3JtLmRhdGUgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6KuL6YG45pOH55m856Wo5pyf5YilXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChmb3JtLm51bSA9PSBcIlwiIHx8ICFmb3JtLm51bS5tYXRjaChpbnZfcnVsZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuiri+i8uOWFpeeZvOelqOato+eiuuagvOW8j1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybS5yYW5kb21OdW0gPT0gXCJcIiB8fCAhZm9ybS5yYW5kb21OdW0ubWF0Y2gocmFuZG9tX3J1bGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLoq4vovLjlhaXnmbznpajpmqjmqZ/norzmraPnorrmoLzlvI9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFmb3JtLmNoZWNrYWdyZWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuiri+WLvumBuOWQjOaEj+iqquaYjlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBncmVjYXB0Y2hhLmV4ZWN1dGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FwdGNoYUNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLlNhdmVJbnZvaWNlKCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5lcnJvckNvZGUgPT09IDIwMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLy3loavlr6vos4fmlpnmiJDlip9cclxuICAgICAgICAgICAgICAgICAgICB2bS5nYUV2YW50KCfnmbznpajnmbvpjIRf5oiQ5Yqf55m76YyEJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlcklkID0gcmVzLmRhdGEubWVtYmVyX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLnNjcm9sbFRvKCdib2R5Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZm9ybXN0ZXAgPSBcImZvcm1vdmVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uYmlydGhJbml0KCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlcy5lcnJvck1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZXNldChpbnZpc2libGVfZ3JlY2FwdGNoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaW52Rm9ybS5udW0gPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmludkZvcm0ucmFuZG9tTnVtID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB2bS5pbnZGb3JtLmNoZWNrYWdyZWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJpcnRoSW5pdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiI2JpcnRoZGF5XCIpLmRhdGVEcm9wZG93bnMoe1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdERhdGU6ICcxOTk5LTAxLTAxJyxcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlGb3JtYXQ6ICd5bWQnLFxyXG4gICAgICAgICAgICAgICAgbWF4QWdlOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBtb250aEZvcm1hdDogJ251bWVyaWMnLFxyXG4gICAgICAgICAgICAgICAgbW9udGhTdWZmaXhlczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBkYXlTdWZmaXhlczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHdyYXBwZXJDbGFzczogJ3NlbGVjdC1iaXJ0aGRheScsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkKFwiLnNlbGVjdC1iaXJ0aGRheSAueWVhclwiKS5hZnRlcignPGxhYmVsIGZvcj1cInllYXJcIj4g5bm0PC9sYWJlbD4nKTtcclxuICAgICAgICAgICAgJChcIi5zZWxlY3QtYmlydGhkYXkgLm1vbnRoXCIpLmFmdGVyKCc8bGFiZWwgZm9yPVwibW9udGhcIj4g5pyIPC9sYWJlbD4nKTtcclxuICAgICAgICAgICAgJChcIi5zZWxlY3QtYmlydGhkYXkgLmRheVwiKS5hZnRlcignPGxhYmVsIGZvcj1cImRheVwiPiDml6U8L2xhYmVsPicpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmlydGhQb3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdm0ucG9wdXBPcGVuKCk7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwcGFnZSA9ICdiaXJ0aGRheSc7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFNhdmVJbnZvaWNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBpbnZfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIHVzZXJfbmFtZTogdm0uaW52Rm9ybS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgY2VsbDogdm0uaW52Rm9ybS5waG9uZSxcclxuICAgICAgICAgICAgICAgIGludl9kYXRlOiB2bS5pbnZGb3JtLmRhdGUsXHJcbiAgICAgICAgICAgICAgICBpbnZfbnVtOiB2bS5pbnZGb3JtLm51bS50b1VwcGVyQ2FzZSgpLFxyXG4gICAgICAgICAgICAgICAgcmFuZG9tX251bWJlcjogdm0uaW52Rm9ybS5yYW5kb21OdW0sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBhcGlVcmwgKyBcIi9pbnZvaWNlRW50cnlcIixcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJWZXJpZnktVG9rZW5cIjogdm0udG9rZW5cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuezu+e1seW/meeijOS4re+8jOiri+eojeW+jOWGjeippiFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZXNldChpbnZpc2libGVfZ3JlY2FwdGNoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IGludl9kYXRhLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG90dGVyeUV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciB4ID0gW107XHJcbiAgICAgICAgICAgIHZhciByYW5nZSA9IDYwO1xyXG4gICAgICAgICAgICB2YXIgY2hlY2sxID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBjaGVjazIgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICByYW5nZSA9IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2bS5kcmFnTG90dGVyeSA9IERyYWdnYWJsZS5jcmVhdGUoXCIjc2hha2VQb2ludFwiLCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInhcIixcclxuICAgICAgICAgICAgICAgIGVkZ2VSZXNpc3RhbmNlOiAwLjY1LFxyXG4gICAgICAgICAgICAgICAgYm91bmRzOiBcIi5mb3J0dW5lLWFyZWFcIixcclxuICAgICAgICAgICAgICAgIHRocm93UHJvcHM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBhdXRvU2Nyb2xsOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgb25EcmFnU3RhcnQ6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHhbMF0gPSBldmVudC5jbGllbnRYIC0gcmFuZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgeFsxXSA9IGV2ZW50LmNsaWVudFggKyBldmVudC5zcmNFbGVtZW50LmNsaWVudFdpZHRoICsgcmFuZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi5sLWNvbnRhaW5lciBcIikuY3NzKCdvdmVyZmxvdy14JywgJ2hpZGRlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmdhRXZhbnQoJ+eZvOelqOeZu+mMhF/pu57kvY/mjInpiJUnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvbkRyYWc6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5jbGllbnRYIDwgeFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVjazEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY2xpZW50WCA+IHhbMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2syID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb25EcmFnRW5kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi5sLWNvbnRhaW5lciBcIikuY3NzKCdvdmVyZmxvdy14JywgJ2luaGVyaXQnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVjazEgJiYgY2hlY2syKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS5sb3R0ZXJ5U3VjY2VzcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubG90dGVyeVN1Y2Nlc3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG90dGVyeVN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgJChcIi5mb3J0dW5lLWFyZWFcIikuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAvLyB2bS5nYUV2YW50KCfnmbznpajnmbvpjIRf5pCW5pmD5oq957GkJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBTYXZlQmlydGhkYXk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGJpcnRoX2RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBtZW1iZXJfaWQ6IHZtLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJpcnRoZGF5OiB2bS5iaXJ0aGRheS5kYXRlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXR1cm4gJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogYXBpVXJsICsgXCIvbWVtYmVyQmlydGhkYXlcIixcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuezu+e1seW/meeijOS4re+8jOiri+eojeW+jOWGjeippiFcIik7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogYmlydGhfZGF0YSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbmRCaXJ0aGRheTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgYmlydGhSZXMgPSAkKCcjYmlydGhkYXlGb3JtJykuc2VyaWFsaXplQXJyYXkoKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYmlydGhSZXMpO1xyXG4gICAgICAgICAgICB2bS5iaXJ0aGRheS5kYXRlID0gYmlydGhSZXNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgIHZtLmJpcnRoZGF5LnllYXIgPSBiaXJ0aFJlc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgdm0uU2F2ZUJpcnRoZGF5KCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5iaXJ0aF9sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5lcnJvckNvZGUgPT09IDIwMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLy3loavlr6vnlJ/ml6XmiJDlip9cclxuICAgICAgICAgICAgICAgICAgICB2bS5hbmltYWxzID0gcGFyc2VJbnQoKHZtLmJpcnRoZGF5LnllYXIgLSAxOTEyKSAlIDEyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh2bS5hbmltYWxzKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5wb3B1cENsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uc2Nyb2xsVG8oJ2JvZHknKTtcclxuICAgICAgICAgICAgICAgICAgICB2bS5mb3Jtc3RlcCA9ICdsb3R0ZXJ5JztcclxuICAgICAgICAgICAgICAgICAgICB2bS5mb3J0dW5lSXNzdWUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzLmVycm9yTXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZvcnR1bmVJc3N1ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyDlgbXmuKzpmYDonrrlhIAs6ZaL5aeL5pCWXHJcbiAgICAgICAgICAgIHZtLnRlc3RHeXJvKCk7XHJcbiAgICAgICAgICAgIHZtLmV2ZW50R3lybygpO1xyXG4gICAgICAgICAgICB2bS5jYW5TaGFrZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZtLmZic2hhcmUoKTtcclxuICAgICAgICAgICAgdmFyIHBlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcmFjYWxlJyk7XHJcbiAgICAgICAgICAgIHBlbi5hZGRFdmVudExpc3RlbmVyKCdhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXZtLmlzR0EpIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5nYUV2YW50KCfnmbznpajnmbvpjIRf5pCW5pmD5oq957GkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaXNHQSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2bS5zY3JvbGxUbygnYm9keScpO1xyXG4gICAgICAgICAgICAgICAgdm0uZm9ybXN0ZXAgPSAnbG90dGVyeV9vdmVyJztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBmYnNoYXJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSBcImh0dHBzOi8vcmVzdWx0LmZyaWVuZG8uY29tLnR3L1wiICsgdm0uYW5pbWFsSXRlbVt2bS5hbmltYWxzXTtcclxuICAgICAgICAgICAgdm0uc2hhcmVMaW5rID0gXCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT1cIiArIHVybCArIFwiJmhhc2h0YWc9JTIzMjAxOeiDvemHj+axguexpOetklwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2FtcGxlT3BlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZtLnBvcHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgdm0ucG9wdXBwYWdlID0gXCJzYW1wbGVcIjtcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNsb3VkX0FuaSgpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcblxyXG4iXX0=
